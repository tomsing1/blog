<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Thomas Sandmann">
<meta name="dcterms.date" content="2024-11-30">

<title>Interacting with box cloud storage: the boxr R package – Thomas Sandmann’s blog</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-01c78b5cd655e4cd89133cf59d535862.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-474c6d7e63be50eb6972897072b39b27.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-fd074d1f3eae4c6c63845f7c4c0fb288.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-0b08c4706a376d5bbb3674841d6c1774.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Thomas Sandmann’s blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/tomsing1"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/thomas-sandmann/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://genomic.social/@thomas_sandmann"> <i class="bi bi-mastodon" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Interacting with box cloud storage: the boxr R package</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i></button></div></div>
                                <div class="quarto-categories">
                <div class="quarto-category">R</div>
                <div class="quarto-category">box</div>
                <div class="quarto-category">TIL</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Thomas Sandmann </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">November 30, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#tldr" id="toc-tldr" class="nav-link active" data-scroll-target="#tldr">tl;dr</a></li>
  <li><a href="#overview" id="toc-overview" class="nav-link" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#creating-a-box-developer-account" id="toc-creating-a-box-developer-account" class="nav-link" data-scroll-target="#creating-a-box-developer-account">Creating a box developer account</a></li>
  <li><a href="#creating-a-custom-app-to-interact-with-box" id="toc-creating-a-custom-app-to-interact-with-box" class="nav-link" data-scroll-target="#creating-a-custom-app-to-interact-with-box">Creating a Custom App to interact with box</a></li>
  <li><a href="#using-oauth2-for-authentication" id="toc-using-oauth2-for-authentication" class="nav-link" data-scroll-target="#using-oauth2-for-authentication">Using OAuth2 for authentication</a>
  <ul>
  <li><a href="#creating-a-new-app-r_oauth" id="toc-creating-a-new-app-r_oauth" class="nav-link" data-scroll-target="#creating-a-new-app-r_oauth">Creating a new app: r_oauth</a></li>
  <li><a href="#authenticating" id="toc-authenticating" class="nav-link" data-scroll-target="#authenticating">Authenticating</a></li>
  <li><a href="#environmental-variables" id="toc-environmental-variables" class="nav-link" data-scroll-target="#environmental-variables">Environmental variables</a></li>
  <li><a href="#the-cache-file" id="toc-the-cache-file" class="nav-link" data-scroll-target="#the-cache-file">The cache file</a></li>
  <li><a href="#writing-and-reading-files-from-box" id="toc-writing-and-reading-files-from-box" class="nav-link" data-scroll-target="#writing-and-reading-files-from-box">Writing and reading files from box</a></li>
  <li><a href="#success" id="toc-success" class="nav-link" data-scroll-target="#success">Success!</a></li>
  </ul></li>
  <li><a href="#using-a-json-web-token-for-authentication" id="toc-using-a-json-web-token-for-authentication" class="nav-link" data-scroll-target="#using-a-json-web-token-for-authentication">Using a JSON Web Token for authentication</a>
  <ul>
  <li><a href="#authorizing-the-jwt-backed-app" id="toc-authorizing-the-jwt-backed-app" class="nav-link" data-scroll-target="#authorizing-the-jwt-backed-app">Authorizing the JWT-backed app</a></li>
  <li><a href="#authenticating-with-the-json-web-token" id="toc-authenticating-with-the-json-web-token" class="nav-link" data-scroll-target="#authenticating-with-the-json-web-token">Authenticating with the JSON web-token</a></li>
  <li><a href="#sharing-files-and-folders-with-the-service-account" id="toc-sharing-files-and-folders-with-the-service-account" class="nav-link" data-scroll-target="#sharing-files-and-folders-with-the-service-account">Sharing files and folders with the service account</a></li>
  <li><a href="#modifying-collaborations" id="toc-modifying-collaborations" class="nav-link" data-scroll-target="#modifying-collaborations">Modifying collaborations</a></li>
  </ul></li>
  <li><a href="#reproducibility" id="toc-reproducibility" class="nav-link" data-scroll-target="#reproducibility">Reproducibility</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="tldr" class="level2">
<h2 class="anchored" data-anchor-id="tldr">tl;dr</h2>
<p>This week, I learned how to create custom apps within the box cloud storage service, and how to read &amp; write files from within R using the awesome <a href="https://cran.r-project.org/package=boxr">boxr R package</a>.</p>
<p>I used two different ways of authenticating with box: OAuth 2.0 and Java Web Tokens (JWT), best suited for interactive or unattended use cases, respectively.</p>
</section>
<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p><a href="https://www.box.com/">box</a> is a commercial cloud storage provider. Many of my colleagues use it through its web interface and share data and metadata files with me.</p>
<p>While box doesn’t offer an official API for R, the excellent <a href="https://cran.r-project.org/package=boxr">boxr R package</a> has enabled me to read &amp; write files without having to manually download them first. The <code>boxr</code> package has <a href="https://r-box.github.io/boxr/">excellent documentation</a>, but I tend to forget how to set it up, especially on a new system, or to assist other colleagues who are new to <code>boxr</code>. That’s why I am documenting my workflow here today.</p>
<p>This tutorial is split into two main parts, using either</p>
<ol type="1">
<li>An interactive app authenticating via OAuth 2.0 or</li>
<li>A service app authenticating with Java Web Tokens (JWT)</li>
</ol>
<p>The former is straightforward to set up and doesn’t require a developer account or authorization by an admin. The latter requires more work to set up, but is a great choice for unattended processes. Please refer to <a href="https://r-box.github.io/boxr/articles/boxr-apps.html">this article in the official boxr documentation</a> for more details.</p>
</section>
<section id="creating-a-box-developer-account" class="level2">
<h2 class="anchored" data-anchor-id="creating-a-box-developer-account">Creating a box developer account</h2>
<p>To interact with box, you need to create an account first (or ask your organization to provide you with one). For individuals, you can sign up for a <a href="https://account.box.com/signup/developer">free developer plan</a>. which is all you need to follow along <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<p>Here, I will assume that you have either already signed up for a box <em>developer</em> account or have access to a paid account e.g.&nbsp;through your organiation, and that you are familiar with logging into it through your web browser.</p>
</section>
<section id="creating-a-custom-app-to-interact-with-box" class="level2">
<h2 class="anchored" data-anchor-id="creating-a-custom-app-to-interact-with-box">Creating a Custom App to interact with box</h2>
<p>Box offers multiple different ways to access content computationally. Instead of a single API, users can create one or more Apps, and configure them to fit their needs.</p>
<p>Here, I am creating a <a href="https://developer.box.com/platform/application-types/#custom-app">Custom App</a>, a versatile option that offers <a href="https://developer.box.com/platform/authentication-methods/">three different ways to authenticate</a>.</p>
<ol type="1">
<li><em>OAuth 2.0</em>: An <em>app</em> using OAuth 2.0 exposes the same permissions to <code>boxr</code> that I have as an interactive user, e.g.&nbsp;it can browse, read, write and share the same files that I can interact with when I am logged into the box web site. That’s a great option e.g.&nbsp;for interactive analyses.</li>
<li><em>Java web token</em>: An <em>app</em> using a <em>JWT</em> creates a new service account, which can only access files and folders that have been explicitly shared with it. (See below for an example). This allows for more granular access control and is my method of choice for unsupervised dashboards or other automation tasks.</li>
<li><em>Client Credentials Grant</em>: Finally, apps can use a <a href="https://developer.box.com/platform/authentication-methods/#client-credentials-grant-ccg">Client Credentials Grant (CCG)</a>, but that’s not something I have explored, yet.</li>
</ol>
<p>In this walkthrough, I will set up two <em>Custom Apps</em>, one using <a href="https://auth0.com/intro-to-iam/what-is-oauth-2">OAuth 2.0</a> and another using a <a href="https://en.wikipedia.org/wiki/JSON_Web_Token">JSON Web Token (JWT)</a> for authentication.</p>
</section>
<section id="using-oauth2-for-authentication" class="level2">
<h2 class="anchored" data-anchor-id="using-oauth2-for-authentication">Using OAuth2 for authentication</h2>
<section id="creating-a-new-app-r_oauth" class="level3">
<h3 class="anchored" data-anchor-id="creating-a-new-app-r_oauth">Creating a new app: r_oauth</h3>
<p>If you want to connect to box computationally, you need to create an <em>app</em> that governs how you interact with the box API. The following instructions assume that you don’t have any apps, yet, so I will create one from scratch.</p>
<ul>
<li>Log into the <a href="https://app.box.com/developers/console">box developer console</a>, with your usual box username &amp; password.</li>
<li>If this is the first app you are creating, you will be presented with three choices. For my purposes, a <code>Custom App</code> is the best choice. (If you already created at least one app before, you will see it listed, and can use the <code>Create Platform App</code> button on the upper right instead, see the JWT section below where I create a second app, below.)</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Screenshot
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="fig-create_app" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-create_app-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="screenshots/create_app.jpg" id="fig-create_app" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-create_app-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<ul>
<li>Next, I choose a suitable name for the app (e.g.&nbsp;<code>r_oauth</code>), and add a brief description before clicking the <code>Next</code> button.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Screenshots
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-custom_app_1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-custom_app_1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="screenshots/custom_app_1.jpg" id="fig-custom_app_1" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-custom_app_1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-custom_app_2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-custom_app_2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="screenshots/custom_app_2.jpg" id="fig-custom_app_2" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-custom_app_2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>On the second page of the modal, I pick <code>User Authentication (OAuth 2.0)</code> as the authentication method and then hit the <code>Create App</code> button.</li>
<li>This takes me to main configuration page of my new <code>r_oauth</code> app.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Screenshot
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="fig-app_config.jpg" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-app_config.jpg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="screenshots/app_config.jpg" id="fig-app_config.jpg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-app_config.jpg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<ul>
<li>The <code>Configuration</code> tab includes the <code>OAuth 2.0 Credentials</code> section that provides me with the <code>Client ID</code> and the <code>Client Secret</code> strings, which are used in the same way as my <code>username</code> and <code>password</code> for my box account. (So I will keep the secret and not share them with anybody!)
<ul>
<li>I can invalidate my current ID / Secret pair and obtain a new set any time by clicking on the <code>Reset</code> button.</li>
</ul></li>
<li>Next, I scroll down to the <code>OAuth 2.0 Redirect URI</code> section of the page, paste <code>http://localhost:1410/</code> into the <code>Redirect URI</code> text box and then hit the blue <code>Add</code> button. The new URI is now shown below the text box.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Screenshot
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="fig-redirect" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-redirect-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="screenshots/redirect.jpg" id="fig-redirect" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-redirect-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<ul>
<li>Finally, I scroll down further to the <code>Application Scopes</code> section. By default, my app only has the <code>Read all files and folders in Box</code> box ticked, providing read-only access. Because I also want to be able to write files and create folders, I also check the <code>Write all files and folders in Box</code> option.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Screenshot
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="fig-write_access" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-write_access-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="screenshots/write_access.jpg" id="fig-write_access" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-write_access-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
$ operator is invalid for atomic vectors
</div>
</div>
<div class="callout-body-container callout-body">
<p>If I forget to grant write access to box, operations that try to modify files or folders fail with the <code>$ operator is invalid for atomic vectors</code> error message.</p>
</div>
</div>
<ul>
<li><p>To make these change permanent, I click the <code>Save Changes</code> button at the top of the Configuration page.</p></li>
<li><p>I keep this configuration page open, so I can refer back to it below.</p></li>
</ul>
</section>
<section id="authenticating" class="level3">
<h3 class="anchored" data-anchor-id="authenticating">Authenticating</h3>
<p>Let’s start by accessing my box account from within R on my local system, e.g. where I can open a web browser to complete the authentication process.</p>
<p>First, I install the <code>boxr</code> package, which is <a href="https://cran.r-project.org/package=boxr">available from CRAN</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"boxr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, I attach the package to my R session and use the <code>box_auth()</code> function to authenticate with the <code>r_oauth</code> app I created above.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boxr)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">boxr.progress =</span> <span class="cn">FALSE</span>, <span class="at">boxr.verbose =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
boxr options
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>I can fine tune the behavior of the <code>boxr</code> package through different <a href="https://ijlyttle.github.io/boxr/reference/boxr_options.html">options</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxr_options</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$boxr.interactive
[1] TRUE

$boxr.print_tibble
[1] FALSE

$boxr.progress
[1] FALSE

$boxr.verbose
[1] FALSE

$boxr.wd
$boxr.wd$id
[1] 0

$boxr.wd$name
[1] "All Files"


$boxr.wd.path
[1] ""</code></pre>
</div>
</div>
<p>For this tutorial, I switch off the progress bar and suppress messages with by setting the <code>boxr.progress</code> and <code>boxr.verbose</code> options to <code>FALSE</code>.</p>
</div>
</div>
</div>
</section>
<section id="environmental-variables" class="level3">
<h3 class="anchored" data-anchor-id="environmental-variables">Environmental variables</h3>
<p>To communicate the <code>Client ID</code> and <code>Client Secret</code> information shown in the <code>Configuration -&gt; OAuth 2.0 Credentials</code> section of my app’s configuration page (see above), I expose them as environmental variables.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>The Client ID and Client Secret strings shown in this tutorial are no longer valid, so please replace them with your own to follow along.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.setenv</span>(<span class="at">BOX_CLIENT_ID=</span><span class="st">"0o5h6s0mey2l5f6l89bkjrmk42vjv9g2"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.setenv</span>(<span class="at">BOX_CLIENT_SECRET=</span><span class="st">"Zfv4UX5Fi2rQAK9Cskcf3RgtFlptrH2c"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Usually, I add the <code>BOX_CLIENT_ID</code> and <code>BOX_CLIENT_SECRET</code> to my <code>.Renviron</code> file instead of specifying them via <code>Sys.setenv()</code>. That way, <code>box_auth()</code> will use them automatically next time and avoid including any credentials in my analysis code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>boxr<span class="sc">::</span><span class="fu">box_auth</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Providing the <code>BOX_CLIENT_ID</code> and <code>BOX_CLIENT_SECRET</code> strings is not sufficient to gain access to my box account, though. To complete the OAuth 2.0 hand-shake, I am now directed to a website, which opens in my default web browser, where I can log into my box account interactively (using my usual username and password). Afterward, I confirm that I want to grant my <code>r_oauth</code> app access to my files on my behalf.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Screenshots
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-login" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-login-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="screenshots/login.jpg" id="fig-login" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-login-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-grant_access" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-grant_access-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="screenshots/grant_access.jpg" id="fig-grant_access" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-grant_access-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>A call to <code>box_auth()</code> is required every time I want to interact with box in an R session, e.g.&nbsp;I include the following two lines at the top of each of my R markdown / quarto documents:</p>
<pre><code>library(boxr)
box_auth()</code></pre>
</div>
</div>
</section>
<section id="the-cache-file" class="level3">
<h3 class="anchored" data-anchor-id="the-cache-file">The cache file</h3>
<p>When <code>box_auth()</code> runs successfully for the first time, it creates a cache file (by default as the hidden <code>~/.box-oauth</code> file in my home directory)<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. The next call to <code>box_auth()</code> will refresh the information stored in the cache file instead of prompting me to sign in via the box website again.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">file.info</span>(<span class="st">"~/.boxr-oauth"</span>)[, <span class="fu">c</span>(<span class="st">"size"</span>, <span class="st">"mode"</span>, <span class="st">"mtime"</span>, <span class="st">"ctime"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              size mode               mtime               ctime
~/.boxr-oauth 5940  600 2024-11-30 10:23:46 2024-11-30 10:23:46</code></pre>
</div>
</div>
</section>
<section id="writing-and-reading-files-from-box" class="level3">
<h3 class="anchored" data-anchor-id="writing-and-reading-files-from-box">Writing and reading files from box</h3>
<p>Now that I have authenticated with my <code>r_oauth</code> app, I can browse the folders and files available to me on box. The <code>box_getwd()</code> function confirms that I am looking at the root directory of my box account, which has the directory ID <code>0</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>boxr<span class="sc">::</span><span class="fu">box_getwd</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p>The <code>box_ls</code> function returns a <a href="https://github.com/r-box/boxr/blob/31d2e7407cc0e6a31a9853fb43f27c48055eb057/R/boxr_s3_classes.R#L27">boxr_object_list S3 object</a> with all objects that are stored in the location specified by the <code>dir_id</code> argument. It can be coerced into a data.frame, e.g.&nbsp;to filter the output with verbs from the <a href="https://cran.r-project.org/package=dplyr">dplyr</a> or <a href="https://cran.r-project.org/package=poorman">poorman</a> R packages.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>objects <span class="ot">&lt;-</span> boxr<span class="sc">::</span><span class="fu">box_ls</span>(<span class="at">dir_id =</span> <span class="fu">box_getwd</span>())</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(objects)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "boxr_object_list"</code></pre>
</div>
</div>
<p>Right now, there is a single folder <code>tutorial</code> in my box account<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>. Its unique identifier is shown in the <code>id</code> column and I can refer to objects in my box account (both folders and files) using this identifier.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(objects)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      name   type           id  size description                  owner
1 tutorial folder 296254108479 12754             tomsing1+box@gmail.com
       path         modified_at content_modified_at sha1 version version_no
1 All Files 2024-11-30 10:35:37 2024-11-30 10:35:37 &lt;NA&gt;       1          1
  version_id
1       &lt;NA&gt;</code></pre>
</div>
</div>
<p>I extract the unique identifier of the <code>tutorial</code> folder, so I can refer to it downstream:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(poorman))</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>folder_id <span class="ot">&lt;-</span> objects <span class="sc">|&gt;</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  poorman<span class="sc">::</span><span class="fu">filter</span>(name <span class="sc">==</span> <span class="st">"tutorial"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  poorman<span class="sc">::</span><span class="fu">pull</span>(<span class="st">"id"</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>folder_id</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "296254108479"</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Alternatively, I can also copy this identifier from the end of the URL that is showin in my web browser when I open the <code>tutorial</code> folder. Similarly pasting the URL https://app.box.com/folder/296254108479 into a web browser opens my <code>tutorial</code> folder there.</p>
</div>
</div>
<p>So let’s store a copy of the <code>mtcars</code> dataset included in R’s <code>dataset</code> package as a CSV file in the <code>tutorials</code> folder (specified by its id, see above).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>boxr<span class="sc">::</span><span class="fu">box_write</span>(<span class="at">object =</span> mtcars, <span class="at">file_name =</span> <span class="st">"mtcars.csv"</span>, <span class="at">dir_id =</span> folder_id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
box.com remote file reference

 name        : mtcars.csv 
 file id     : 1713588728473 
 version     : V10 
 size        : 1.3 kB 
 modified at : 2024-11-30 10:36:46 
 created at  : 2024-11-30 10:36:46 
 uploaded by : tomsing1+box@gmail.com 
 owned by    : tomsing1+box@gmail.com 
 shared link : None 

 parent folder name :  tutorial 
 parent folder id   :  296254108479 </code></pre>
</div>
</div>
<p>To verify the successful upload, I can list the contents of the <code>tutorial</code> folder:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>boxr<span class="sc">::</span><span class="fu">box_ls</span>(<span class="at">dir_id =</span> folder_id) <span class="sc">|&gt;</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        name type            id size description                  owner
1 mtcars.csv file 1713588728473 1281             tomsing1+box@gmail.com
2 mtcars.rds file 1713594291978 1225             tomsing1+box@gmail.com
                path         modified_at content_modified_at
1 All Files/tutorial 2024-11-30 10:36:46 2024-11-30 10:36:46
2 All Files/tutorial 2024-11-30 10:35:37 2024-11-30 10:35:37
                                      sha1 version version_no    version_id
1 dfd44f97e2bd9b5efe4bd2e87851cfe717f3fc2f      10         10 1886588891382
2 c41ea4b33768b6a4ae886e592e13090939fab642       1          1 1886592083178</code></pre>
</div>
</div>
<p>To read the file into my R session, I extract the CSV file’s id and pass it to the <code>box_read_csv</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>file_id <span class="ot">&lt;-</span> boxr<span class="sc">::</span><span class="fu">box_ls</span>(<span class="at">dir_id =</span> folder_id) <span class="sc">|&gt;</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  poorman<span class="sc">::</span><span class="fu">filter</span>(name <span class="sc">==</span> <span class="st">"mtcars.csv"</span>) <span class="sc">|&gt;</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  poorman<span class="sc">::</span><span class="fu">pull</span>(id)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>boxr<span class="sc">::</span><span class="fu">box_read_csv</span>(file_id) <span class="sc">|&gt;</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   mpg cyl disp  hp drat    wt  qsec vs am gear carb
1 21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
2 21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
3 22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
4 21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
5 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
6 18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Functions to interact with files stored in box
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>The <code>boxr</code> packages offers <a href="https://r-box.github.io/boxr/reference/index.html">convenience functions</a> for different file types, e.g.</p>
<ul>
<li><a href="https://r-box.github.io/boxr/reference/box_write.html">box_write()</a></li>
<li><a href="https://r-box.github.io/boxr/reference/box_save_rds.html">box_save_rds()</a></li>
<li><a href="https://r-box.github.io/boxr/reference/box_save.html">box_save()</a></li>
<li><a href="https://r-box.github.io/boxr/reference/box_read_csv.html">box_read_csv()</a></li>
<li><a href="https://r-box.github.io/boxr/reference/box_read_tsv.html">box_read_tsv()</a></li>
<li><a href="https://r-box.github.io/boxr/reference/box_read_json.html">box_read_json()</a></li>
<li><a href="https://r-box.github.io/boxr/reference/box_read_excel.html">box_read_excel()</a></li>
<li><a href="https://r-box.github.io/boxr/reference/box_read_rds.html">box_read_rds()</a></li>
</ul>
<p>The <code>box_write</code> and <code>box_read</code> functions allow me to specify the function that write / reads the file myself via the <code>write_fun</code> and <code>read_fun</code> arguments, respectively.</p>
<p>To simply copy files from / to box without reading them, I can use the <a href="https://r-box.github.io/boxr/reference/box_dl.html">box_dl()</a> and <a href="https://r-box.github.io/boxr/reference/box_ul.html">box_ul()</a>, respectively.</p>
<p>Finally, I can also move the file into the trash (from which it will be automatically removed after one month) with the <a href="https://r-box.github.io/boxr/reference/box_delete_file.html">box_delete_file()</a> function.</p>
</div>
</div>
</div>
<p>For other functions, e.g.&nbsp;to <a href="https://support.box.com/hc/en-us/articles/360043696314-Search-for-Files-Folders-and-Content">search the box index</a>, please refer to the <a href="https://r-box.github.io/boxr/reference/index.html">boxr reference</a>.</p>
</section>
<section id="success" class="level3">
<h3 class="anchored" data-anchor-id="success">Success!</h3>
<p>Great! Now I have a working <em>app</em> that allows me to interact with folders and files in my box account, all from within the comfort of my R session.</p>
</section>
</section>
<section id="using-a-json-web-token-for-authentication" class="level2">
<h2 class="anchored" data-anchor-id="using-a-json-web-token-for-authentication">Using a JSON Web Token for authentication</h2>
<p>Another way of authenticating a <em>Custom App</em> within box is via a <a href="https://en.wikipedia.org/wiki/JSON_Web_Token">JSON Web Token</a>. This requires that the <a href="https://cran.r-project.org/package=jose">jose R package</a> is installed on your system:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jose)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In this mode, the app authenticates using a signed JWT token, which requires a public/private key-pair for added security (see below).</p>
<p>To authenticate via this route, I need to create another app in my <a href="https://app.box.com/developers/console">box developer console</a>. Because I already created a first app (see above), the console’s home screen now looks different, listing my <code>r_oauth</code> app. To add another app, I click the blue <code>Create Platform App</code> in the upper right corner of the page.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Screenshot
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><img src="screenshots/second_app.jpg" class="img-fluid"></p>
</div>
</div>
</div>
<p>Once again, I choose to create a <code>Custom App</code> and pick a unique name for my app, e.g.&nbsp;<code>r_jwt</code>. But on the second page of the modal, I now choose <code>Server Authentication (with JWT)</code> as my authentication method before clicking the <code>Create App</code> button.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Screenshots
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-custom_app_1_jwt" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-custom_app_1_jwt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="screenshots/custom_app_1_jwt.jpg" id="fig-custom_app_1_jwt" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-custom_app_1_jwt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-custom_app_2_jwt" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-custom_app_2_jwt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="screenshots/custom_app_2_jwt.jpg" id="fig-custom_app_2_jwt" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-custom_app_2_jwt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Afterwards, I am redirected to the configuration page of my new <code>r_jwt</code> app, where I make the following changes:</p>
<ul>
<li><p>As in my first example, I allow the app to write / modify files and folders on my behalf (see <a href="#fig-write_access" class="quarto-xref">Figure&nbsp;6</a>).</p></li>
<li><p>To make these changes permanent, I click the blue <code>Save Changes</code> button on the upper right of the Configuration page.</p></li>
<li><p>To use a <code>JWT</code> for authentication, I need one more piece of information: an RSA keypair to sign and authenticate the requests made by my app. I scroll down to the<code>Add and Manage Public Keys</code> section.</p>
<p>There, I use the <code>Generate a new Public/Private Key pair</code> button to generate and download a new key pair for my app.</p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Screenshot
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="fig-keys" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-keys-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="screenshots/keys.jpg" id="fig-keys" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-keys-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>The key information is downloaded in a JSON file with content similar to this:</p>
<pre><code>{
"boxAppSettings": {
  "clientID": "jlccq2qe365jy2wo4llm9z9isz9didhv",
  "clientSecret": "VSN5WNe9q4hI2h9PJbppQKsIxm8oxJp8",
  "appAuth": {
    "publicKeyID": "wvslfab2",
    "privateKey": "-----BEGIN ENCRYPTED PRIVATE KEY-----\nMIIFHDBOBgkqhki[TRUNCATED]RvOqeWR1mg==\n-----END ENCRYPTED PRIVATE KEY-----\n",
    "passphrase": "87babeaed61e4ad87309f8063918bd04"
  }
},
"enterpriseID": "1246725007"
}</code></pre>
<p>This JSON file contains the</p>
<ul>
<li><code>clientID</code>: this unique identifier of the app - I will need it to authorize my app in the Admin console (see below).</li>
<li><code>clientSecret</code>: the secret associated with the <code>clientID</code></li>
<li><code>appAuth</code>: the public and private RSA key pair, along with their pass phrase</li>
<li><code>enterpriseID</code>: the unique identifier of my <code>enterprise</code>, e.g.&nbsp;the organization that manages my box account<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>.</li>
</ul>
<p>The contents (or location) of this file is required to authenticate with box. The <a href="https://r-box.github.io/boxr/articles/boxr-app-service.html#using-a-service-app">boxr package authors reccommend</a> creating storing this file in a newly created <code>~/.boxr-auth</code> folder, and in this tutorial stored the file there under the path <code>~/.boxr-auth/jwt_config.json</code> <a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>The contents of the JSON file is sufficient to access my box account. So I need to keep it secret, and - if in doubt - revoke and replace the key pair with a new one.</p>
</div>
</div>
<section id="authorizing-the-jwt-backed-app" class="level3">
<h3 class="anchored" data-anchor-id="authorizing-the-jwt-backed-app">Authorizing the JWT-backed app</h3>
<p>In contrast to the OAuth 2.0 app I created above, any JWT-backed app needs to be explicitly authorized by the organization’s admin. Here, I am using a free developer box account, so I am my own admin and can perform the following steps.</p>
<ol type="1">
<li>I navigate to the <a href="https://app.box.com/folder/0">home page of my box account</a> and click on the <code>Admin Console</code> button on the lower left of the page. (If you don’t see an option to access the Admin Console the you either have not signed up for a <em>Developer</em> account, or your organization has dedicated admins<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> and you are not one of them.)</li>
</ol>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Screenshot
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="fig-admin_console" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-admin_console-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="screenshots/admin_console.jpg" id="fig-admin_console" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-admin_console-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<ol start="2" type="1">
<li>Within the admin console, I select <code>Integrations</code> in the left hand menu, and then navigate to the <code>Platform Apps Manager</code> tab. Here, I can see all previously authorized apps - but as this is my first JWT app there aren’t any listed.</li>
</ol>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Screenshot
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="fig-platform_apps_manager_1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-platform_apps_manager_1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="screenshots/platform_apps_manager_1.jpg" id="fig-platform_apps_manager_1" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-platform_apps_manager_1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<ol start="3" type="1">
<li>To add my new app, I click on the <code>Add Platform App</code> button on the upper right of the page.</li>
</ol>
<ul>
<li>Within the modal that pops up, I paste my app’s <code>ClientID</code>, which I can find either in the JSON token file or on the app’s configuration page ( see above).</li>
<li>After pressing the <code>Next</code> button, I can confirm the details and authorize my app.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Screenshots
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p><img src="screenshots/add_platform_app_1.jpg" id="fig-add_platform_app_1" class="img-fluid"> <img src="screenshots/add_platform_app_2.jpg" id="fig-add_platform_app_2" class="img-fluid"></p>
</div>
</div>
</div>
</div>
</div>
</div>
<ol start="4" type="1">
<li>Once the authorization is complete, I can see my <code>r_jwt</code> app listed in the <code>Platform Apps Manager</code> list.</li>
</ol>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-20-contents" aria-controls="callout-20" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Screenshot
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-20" class="callout-20-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="fig-platform_apps_manager_2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-platform_apps_manager_2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="screenshots/platform_apps_manager_2.jpg" id="fig-platform_apps_manager_2" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-platform_apps_manager_2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="authenticating-with-the-json-web-token" class="level3">
<h3 class="anchored" data-anchor-id="authenticating-with-the-json-web-token">Authenticating with the JSON web-token</h3>
<p>For JWT authentication, the <code>box_auth_service()</code> function is used. I can either point its <code>token_file</code> argument to the JSON file downloaded above, or provide its content as a string via its <code>token_text</code> argument <a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a>. (Alternatively, I could also provide the path to the JSON file via the <code>BOX_TOKEN_FILE</code> environmental variable.)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>boxr<span class="sc">::</span><span class="fu">box_auth_service</span>(<span class="at">token_file =</span> <span class="st">"~/.boxr-auth/jwt_config.json"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Once the <code>box_auth_service()</code> call has completed successfully, I can explore the files and folders in box.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>boxr<span class="sc">::</span><span class="fu">box_ls</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
box.com remote object list: Empty (no objects returned)</code></pre>
</div>
</div>
<p>Wait, the <code>box_ls()</code> command does return any objects - where is my <code>tutorials</code> folder? This bring me to a key difference between OAuth 2.0 and JWT backed apps: the former has access to my usual box account. But the latter uses a <em>service account</em>, an entirely separate box account that has access to <em>its own</em> file system, but cannot access those of my main account.</p>
</section>
<section id="sharing-files-and-folders-with-the-service-account" class="level3">
<h3 class="anchored" data-anchor-id="sharing-files-and-folders-with-the-service-account">Sharing files and folders with the service account</h3>
<p>For some applications, up- and down-loading files that are <em>only</em> accessible via the service account might be all that is needed. But to collaborate with others (including my interactive account), it is helpful to <em>share</em> files with this new account. That’s what <a href="https://r-box.github.io/boxr/articles/boxr-app-service.html#collaboration-workflows">collaboration workflows</a> are for.</p>
<p>Here, I will give the service account access to my <code>tutorial</code> folder, which is owned by my main account (and which I accessed using OAuth 2.0 above).</p>
<p>To share the folder (e.g.&nbsp;to <em>create a collaboration</em> in box’ lingo), I need to</p>
<ol type="1">
<li>Log in to my main account, either interactive via the box website or using OAuth 2.0.</li>
<li>Provide the identifier of the folder I want to share</li>
<li>Provide <code>user_id</code> of the service account I want to share the folder with.</li>
</ol>
<ul>
<li>This information was returned by the <code>box_auth_service()</code> call above. In this example the <code>user_id</code> is <code>38323581037</code>.</li>
</ul>
<ol start="4" type="1">
<li>Decide on the <code>role</code>, e.g.&nbsp;the set of permissions, I want to grant to the service account.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-17"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><a class="code-annotation-anchor" data-target-cell="annotated-cell-17" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-17-1" class="code-annotation-target"><a href="#annotated-cell-17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">box_auth</span>()</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-17" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-17-2" class="code-annotation-target"><a href="#annotated-cell-17-2" aria-hidden="true" tabindex="-1"></a>objects <span class="ot">&lt;-</span> boxr<span class="sc">::</span><span class="fu">box_ls</span>()</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-17" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-17-3" class="code-annotation-target"><a href="#annotated-cell-17-3" aria-hidden="true" tabindex="-1"></a>folder_id <span class="ot">&lt;-</span> objects <span class="sc">|&gt;</span></span>
<span id="annotated-cell-17-4"><a href="#annotated-cell-17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-17-5"><a href="#annotated-cell-17-5" aria-hidden="true" tabindex="-1"></a>  poorman<span class="sc">::</span><span class="fu">filter</span>(name <span class="sc">==</span> <span class="st">"tutorial"</span>) <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-17-6"><a href="#annotated-cell-17-6" aria-hidden="true" tabindex="-1"></a>  poorman<span class="sc">::</span><span class="fu">pull</span>(<span class="st">"id"</span>)</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-17" data-target-annotation="4" onclick="event.preventDefault();">4</a><span id="annotated-cell-17-7" class="code-annotation-target"><a href="#annotated-cell-17-7" aria-hidden="true" tabindex="-1"></a>boxr<span class="sc">::</span><span class="fu">box_collab_get</span>(folder_id)</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-17" data-target-annotation="5" onclick="event.preventDefault();">5</a><span id="annotated-cell-17-8" class="code-annotation-target"><a href="#annotated-cell-17-8" aria-hidden="true" tabindex="-1"></a>boxr<span class="sc">::</span><span class="fu">box_collab_create</span>(</span>
<span id="annotated-cell-17-9"><a href="#annotated-cell-17-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">dir_id =</span> folder_id, </span>
<span id="annotated-cell-17-10"><a href="#annotated-cell-17-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">user_id =</span> <span class="st">"38323581037"</span>, </span>
<span id="annotated-cell-17-11"><a href="#annotated-cell-17-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">role =</span> <span class="st">"co-owner"</span>) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-17-12"><a href="#annotated-cell-17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-17" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-17" data-code-lines="1" data-code-annotation="1">Re-authenticate with my OAuth 2.0 credentials.</span>
</dd>
<dt data-target-cell="annotated-cell-17" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-17" data-code-lines="2" data-code-annotation="2">List files &amp; folders at the root of my box account.</span>
</dd>
<dt data-target-cell="annotated-cell-17" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-17" data-code-lines="3" data-code-annotation="3">Extract the identifier of the <code>tutorial</code> folder.</span>
</dd>
<dt data-target-cell="annotated-cell-17" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-17" data-code-lines="7" data-code-annotation="4">Confirm that the folder currently doesn’t have collaborators, e.g.&nbsp;is not shared with any other box account (service or otherwise).</span>
</dd>
<dt data-target-cell="annotated-cell-17" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-17" data-code-lines="8" data-code-annotation="5">Share the <code>tutorial</code> folder with the service account, whose use_id is <code>38323581037</code>.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>           type          id created_by.type created_by.id created_by.name
1 collaboration 58843247194            user   38300848207 Thomas Sandmann
        created_by.login                created_at               modified_at
1 tomsing1+box@gmail.com 2024-11-30T10:36:50-08:00 2024-11-30T10:36:50-08:00
  expires_at   status accessible_by.type accessible_by.id accessible_by.name
1       &lt;NA&gt; accepted               user      38323581037              r_jwt
                                  accessible_by.login accessible_by.is_active
1 AutomationUser_2316060_8nQ4K9ugzs@boxdevedition.com                    TRUE
  invite_email     role           acknowledged_at item.type      item.id
1         &lt;NA&gt; co-owner 2024-11-30T10:36:50-08:00    folder 296254108479
  item.sequence_id item.etag item.name is_access_only
1                0         0  tutorial          FALSE</code></pre>
</div>
</div>
<p>Now that the service account has access to the <code>tutorial</code> folder, I re-authenticate via <code>box_auth_service(). The</code>r_jwt<code>app can now list the  contents of the</code>tutorial` folder:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>boxr<span class="sc">::</span><span class="fu">box_auth_service</span>(<span class="at">token_file =</span> <span class="st">"~/.boxr-auth/jwt_config.json"</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>objects <span class="ot">&lt;-</span> boxr<span class="sc">::</span><span class="fu">box_ls</span>(folder_id)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>objects <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        name type            id size description                  owner
1 mtcars.csv file 1713588728473 1281             tomsing1+box@gmail.com
2 mtcars.rds file 1713594291978 1225             tomsing1+box@gmail.com
                path         modified_at content_modified_at
1 All Files/tutorial 2024-11-30 10:36:46 2024-11-30 10:36:46
2 All Files/tutorial 2024-11-30 10:35:37 2024-11-30 10:35:37
                                      sha1 version version_no    version_id
1 dfd44f97e2bd9b5efe4bd2e87851cfe717f3fc2f      10         10 1886588891382
2 c41ea4b33768b6a4ae886e592e13090939fab642       1          1 1886592083178</code></pre>
</div>
</div>
<p>and it can also write to it:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>boxr<span class="sc">::</span><span class="fu">box_save_rds</span>(<span class="at">object =</span> mtcars,</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">dir_id =</span> folder_id, </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">file_name =</span> <span class="st">"mtcars.rds"</span>,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">description =</span> <span class="st">"The mtcars dataset serialized as an RDS file"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
box.com remote file reference

 name        : mtcars.rds 
 description : The mtcars dataset serialized as an RDS file 
 file id     : 1713594291978 
 version     : V3 
 size        : 1.2 kB 
 modified at : 2024-11-30 10:36:53 
 created at  : 2024-11-30 10:36:53 
 uploaded by : AutomationUser_2316060_8nQ4K9ugzs@boxdevedition.com 
 owned by    : tomsing1+box@gmail.com 
 shared link : None 

 parent folder name :  tutorial 
 parent folder id   :  296254108479 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>boxr<span class="sc">::</span><span class="fu">box_ls</span>(<span class="at">dir_id =</span> folder_id) <span class="sc">|&gt;</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        name type            id size
1 mtcars.csv file 1713588728473 1281
2 mtcars.rds file 1713594291978 1225
                                   description                  owner
1                                              tomsing1+box@gmail.com
2 The mtcars dataset serialized as an RDS file tomsing1+box@gmail.com
                path         modified_at content_modified_at
1 All Files/tutorial 2024-11-30 10:36:46 2024-11-30 10:36:46
2 All Files/tutorial 2024-11-30 10:36:53 2024-11-30 10:36:53
                                      sha1 version version_no    version_id
1 dfd44f97e2bd9b5efe4bd2e87851cfe717f3fc2f      10         10 1886588891382
2 c41ea4b33768b6a4ae886e592e13090939fab642       3          3 1886587197566</code></pre>
</div>
</div>
</section>
<section id="modifying-collaborations" class="level3">
<h3 class="anchored" data-anchor-id="modifying-collaborations">Modifying collaborations</h3>
<p>We can also revoke the permissions of the service account, by deleting the collaboration, if necessary:</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-21"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><a class="code-annotation-anchor" data-target-cell="annotated-cell-21" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-21-1" class="code-annotation-target"><a href="#annotated-cell-21-1" aria-hidden="true" tabindex="-1"></a>boxr<span class="sc">::</span><span class="fu">box_auth</span>()</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-21" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-21-2" class="code-annotation-target"><a href="#annotated-cell-21-2" aria-hidden="true" tabindex="-1"></a>collab <span class="ot">&lt;-</span> boxr<span class="sc">::</span><span class="fu">box_collab_get</span>(folder_id)</span>
<span id="annotated-cell-21-3"><a href="#annotated-cell-21-3" aria-hidden="true" tabindex="-1"></a>collab_id <span class="ot">&lt;-</span> collab <span class="sc">|&gt;</span></span>
<span id="annotated-cell-21-4"><a href="#annotated-cell-21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="annotated-cell-21-5"><a href="#annotated-cell-21-5" aria-hidden="true" tabindex="-1"></a>  poorman<span class="sc">::</span><span class="fu">pull</span>(id)</span>
<span id="annotated-cell-21-6"><a href="#annotated-cell-21-6" aria-hidden="true" tabindex="-1"></a>boxr<span class="sc">::</span><span class="fu">box_collab_delete</span>(collab_id)</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-21" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-21-7" class="code-annotation-target"><a href="#annotated-cell-21-7" aria-hidden="true" tabindex="-1"></a>collab <span class="ot">&lt;-</span> boxr<span class="sc">::</span><span class="fu">box_collab_get</span>(folder_id)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-21" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-21" data-code-lines="1" data-code-annotation="1">Re-authenticate as the original owner of the folder.</span>
</dd>
<dt data-target-cell="annotated-cell-21" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-21" data-code-lines="2" data-code-annotation="2">Retrieve information about the sharing settings / collaborations of the folder, including the <code>id</code> of the collaboration.</span>
</dd>
<dt data-target-cell="annotated-cell-21" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-21" data-code-lines="7" data-code-annotation="3">Delete the collaboration by specifying its unique id.</span>
</dd>
</dl>
</div>
</div>
</section>
</section>
<section id="reproducibility" class="level2">
<h2 class="anchored" data-anchor-id="reproducibility">Reproducibility</h2>
<details>
<summary>
Session Information
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.4.1 (2024-06-14)
Platform: x86_64-pc-linux-gnu
Running under: Debian GNU/Linux 12 (bookworm)

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.21.so;  LAPACK version 3.11.0

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

time zone: America/Los_Angeles
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices datasets  utils     methods   base     

other attached packages:
[1] jose_1.2.1    openssl_2.2.2 poorman_0.2.7 boxr_0.3.6   

loaded via a namespace (and not attached):
 [1] bit_4.5.0         jsonlite_1.8.9    dplyr_1.1.4       compiler_4.4.1   
 [5] renv_1.0.11       tidyselect_1.2.1  stringr_1.5.1     assertthat_0.2.1 
 [9] yaml_2.3.10       fastmap_1.2.0     mime_0.12         R6_2.5.1         
[13] generics_0.1.3    curl_6.0.1        knitr_1.49        tibble_3.2.1     
[17] pillar_1.9.0      R.utils_2.12.3    rlang_1.1.4       utf8_1.2.4       
[21] stringi_1.8.4     xfun_0.49         fs_1.6.5          bit64_4.5.2      
[25] cli_3.6.3         magrittr_2.0.3    rio_1.2.3         digest_0.6.37    
[29] askpass_1.2.1     lifecycle_1.0.4   R.methodsS3_1.8.2 R.oo_1.27.0      
[33] vctrs_0.6.5       evaluate_1.0.1    glue_1.8.0        data.table_1.16.2
[37] fansi_1.0.6       rmarkdown_2.29    purrr_1.0.2       httr_1.4.7       
[41] tools_4.4.1       pkgconfig_2.0.3   htmltools_0.5.8.1</code></pre>
</div>
</div>
</details>


<!-- -->

</section>


<p><a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png"></a><br>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</p><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>The main difference between a free <em>developer</em> account and a regular free account is that the developer version has access to the administrator console, which will allow you to authorize JWT and CCG applications (<a href="https://community.box.com/sdks-and-tools-7/free-developer-accounts-are-back-29">source</a>). If you are part of an organization with dedicated admins, then they can authorize apps that use these authentication methods for you. With a regular (e.g.&nbsp;non-developer) free account you can still use OAuth 2.0 for authentication, but won’t be able to run the code examples shown in the JWT section of this tutorial.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>To create cache file under a different path, I could specify it’s location via the <code>cache</code> argument of the <code>box_auth()</code> function. For example, I could point to a network drive that is accessible at the same path from different computers.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>The <code>dir_id</code> defaults to the output of <code>box_getwd()</code> and I only specify it here explicitly to highlight that this argument is available. And yes, there is also a <code>box_setwd()</code> function to set the remote working directory.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Please note that my <code>enterpriseID</code> is set, even though I am a single developer on a free box plan. If your <code>enterpriseID</code> is set to “0”, you probably didn’t sign up for a <em>Developer</em> account. (Only free Developer accounts or paid plans can authorize apps via JWT or CCG).<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>The authors also recommend to keep access to the folder restricted if you are on a system shared with others, e.g.&nbsp;by creating the directory with the <code>fs::dir_create("~/.boxr-auth", mode = 700)</code> command.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>If you are part of an organization with dedicated admins, you need to ask them to authorize your app for you, and provide them with its <code>ClienID</code>.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>I do some of my analyses using <a href="https://saturncloud.io/">Saturn Cloud</a>, which offers convenient ways to inject <em>secrets</em> into cloud instances - either as environmental variables or text files. Because the JWT file is plain text, it works very well with that setup.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/tomsing1\.github\.io\/blog\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="tomsing1/blog" data-repo-id="R_kgDOIZ9LJw" data-category="Announcements" data-category-id="DIC_kwDOIZ9LJ84CTvnC" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark"><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb38" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Interacting with box cloud storage: the boxr R package"</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Thomas Sandmann"</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2024-11-30"</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: true</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="an">freeze:</span><span class="co"> true</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [R, box, TIL]</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="co">  markdown:</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="co">    wrap: 72</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a><span class="co">    anchor-sections: true</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 4</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools:</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a><span class="co">      source: true</span></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a><span class="co">      toggle: false</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a><span class="co">      caption: none</span></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>renv<span class="sc">::</span><span class="fu">use</span>(<span class="at">lockfile =</span> <span class="fu">file.path</span>(<span class="fu">path.expand</span>(<span class="st">"~"</span>), <span class="st">"repositories"</span>, <span class="st">"blog"</span>, </span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"posts"</span>, <span class="st">"boxr"</span>, <span class="st">"renv"</span>, <span class="st">"profiles"</span>, <span class="st">"boxr"</span>,</span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"renv.lock"</span>))</span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a><span class="fu">## tl;dr</span></span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>This week, I learned how to create custom apps within the box cloud storage</span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>service, and how to read &amp; write files from within R using the awesome </span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">boxr R package</span><span class="co">](https://cran.r-project.org/package=boxr)</span>. </span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>I used two different ways of authenticating with box: OAuth 2.0 and Java Web</span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a>Tokens (JWT), best suited for interactive or unattended use cases, respectively.</span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a><span class="fu">## Overview</span></span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">box</span><span class="co">](https://www.box.com/)</span></span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a>is a commercial cloud storage provider. Many of my colleagues use it through</span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a>its web interface and share data and metadata files with me.</span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a>While box doesn't offer an official API for R, the excellent </span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">boxr R package</span><span class="co">](https://cran.r-project.org/package=boxr)</span></span>
<span id="cb38-53"><a href="#cb38-53" aria-hidden="true" tabindex="-1"></a>has enabled me to read &amp; write files without having to manually download them</span>
<span id="cb38-54"><a href="#cb38-54" aria-hidden="true" tabindex="-1"></a>first. The <span class="in">`boxr`</span> package has</span>
<span id="cb38-55"><a href="#cb38-55" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">excellent documentation</span><span class="co">](https://r-box.github.io/boxr/)</span>, but I tend to forget</span>
<span id="cb38-56"><a href="#cb38-56" aria-hidden="true" tabindex="-1"></a>how to set it up, especially on a new system, or to assist other colleagues who</span>
<span id="cb38-57"><a href="#cb38-57" aria-hidden="true" tabindex="-1"></a>are new to <span class="in">`boxr`</span>. That's why I am documenting my workflow here today.</span>
<span id="cb38-58"><a href="#cb38-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-59"><a href="#cb38-59" aria-hidden="true" tabindex="-1"></a>This tutorial is split into two main parts, using either</span>
<span id="cb38-60"><a href="#cb38-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-61"><a href="#cb38-61" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>An interactive app authenticating via OAuth 2.0 or</span>
<span id="cb38-62"><a href="#cb38-62" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>A service app authenticating with Java Web Tokens (JWT)</span>
<span id="cb38-63"><a href="#cb38-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-64"><a href="#cb38-64" aria-hidden="true" tabindex="-1"></a>The former is straightforward to set up and doesn't require</span>
<span id="cb38-65"><a href="#cb38-65" aria-hidden="true" tabindex="-1"></a>a developer account or authorization by an admin. The latter requires more work</span>
<span id="cb38-66"><a href="#cb38-66" aria-hidden="true" tabindex="-1"></a>to set up, but is a great choice for unattended processes. Please refer to </span>
<span id="cb38-67"><a href="#cb38-67" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">this article in the official boxr documentation</span><span class="co">](https://r-box.github.io/boxr/articles/boxr-apps.html)</span></span>
<span id="cb38-68"><a href="#cb38-68" aria-hidden="true" tabindex="-1"></a>for more details.</span>
<span id="cb38-69"><a href="#cb38-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-70"><a href="#cb38-70" aria-hidden="true" tabindex="-1"></a><span class="fu">## Creating a box developer account</span></span>
<span id="cb38-71"><a href="#cb38-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-72"><a href="#cb38-72" aria-hidden="true" tabindex="-1"></a>To interact with box, you need to create an account first (or ask your </span>
<span id="cb38-73"><a href="#cb38-73" aria-hidden="true" tabindex="-1"></a>organization to provide you with one). For individuals, you can sign up for a</span>
<span id="cb38-74"><a href="#cb38-74" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">free developer plan</span><span class="co">](https://account.box.com/signup/developer)</span>.</span>
<span id="cb38-75"><a href="#cb38-75" aria-hidden="true" tabindex="-1"></a>which is all you need to follow along <span class="ot">[^1]</span>.</span>
<span id="cb38-76"><a href="#cb38-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-77"><a href="#cb38-77" aria-hidden="true" tabindex="-1"></a>Here, I will assume that you have either already signed up for a box *developer*</span>
<span id="cb38-78"><a href="#cb38-78" aria-hidden="true" tabindex="-1"></a>account or have access to a paid account e.g. through your organiation, </span>
<span id="cb38-79"><a href="#cb38-79" aria-hidden="true" tabindex="-1"></a>and that you are familiar with logging into it through your web browser.</span>
<span id="cb38-80"><a href="#cb38-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-81"><a href="#cb38-81" aria-hidden="true" tabindex="-1"></a><span class="ot">[^1]: </span>The main difference between a free *developer* account and a regular free </span>
<span id="cb38-82"><a href="#cb38-82" aria-hidden="true" tabindex="-1"></a>account is that the developer version has access to the administrator console,</span>
<span id="cb38-83"><a href="#cb38-83" aria-hidden="true" tabindex="-1"></a>which will allow you to authorize JWT and CCG applications (<span class="co">[</span><span class="ot">source</span><span class="co">](https://community.box.com/sdks-and-tools-7/free-developer-accounts-are-back-29)</span>).</span>
<span id="cb38-84"><a href="#cb38-84" aria-hidden="true" tabindex="-1"></a>If you are part of an organization with dedicated admins, then they can</span>
<span id="cb38-85"><a href="#cb38-85" aria-hidden="true" tabindex="-1"></a>authorize apps that use these authentication methods for you. With a regular</span>
<span id="cb38-86"><a href="#cb38-86" aria-hidden="true" tabindex="-1"></a>(e.g. non-developer) free account you can still use OAuth 2.0 for</span>
<span id="cb38-87"><a href="#cb38-87" aria-hidden="true" tabindex="-1"></a>authentication, but won't be able to run the code examples shown in the JWT </span>
<span id="cb38-88"><a href="#cb38-88" aria-hidden="true" tabindex="-1"></a>section of this tutorial.</span>
<span id="cb38-89"><a href="#cb38-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-90"><a href="#cb38-90" aria-hidden="true" tabindex="-1"></a><span class="fu">## Creating a Custom App to interact with box</span></span>
<span id="cb38-91"><a href="#cb38-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-92"><a href="#cb38-92" aria-hidden="true" tabindex="-1"></a>Box offers multiple different ways to access content computationally. Instead</span>
<span id="cb38-93"><a href="#cb38-93" aria-hidden="true" tabindex="-1"></a>of a single API, users can create one or more Apps, and configure them to fit</span>
<span id="cb38-94"><a href="#cb38-94" aria-hidden="true" tabindex="-1"></a>their needs.</span>
<span id="cb38-95"><a href="#cb38-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-96"><a href="#cb38-96" aria-hidden="true" tabindex="-1"></a>Here, I am creating a </span>
<span id="cb38-97"><a href="#cb38-97" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Custom App</span><span class="co">](https://developer.box.com/platform/application-types/#custom-app)</span>, </span>
<span id="cb38-98"><a href="#cb38-98" aria-hidden="true" tabindex="-1"></a>a versatile option that offers </span>
<span id="cb38-99"><a href="#cb38-99" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">three different ways to authenticate</span><span class="co">](https://developer.box.com/platform/authentication-methods/)</span>.</span>
<span id="cb38-100"><a href="#cb38-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-101"><a href="#cb38-101" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>*OAuth 2.0*: An _app_ using OAuth 2.0 exposes the same permissions to <span class="in">`boxr`</span></span>
<span id="cb38-102"><a href="#cb38-102" aria-hidden="true" tabindex="-1"></a>that I have as an  interactive user, e.g. it can browse, read, write and share</span>
<span id="cb38-103"><a href="#cb38-103" aria-hidden="true" tabindex="-1"></a>the same files that I can interact with when I am logged into the box web</span>
<span id="cb38-104"><a href="#cb38-104" aria-hidden="true" tabindex="-1"></a>site. That's a great option e.g. for interactive analyses.</span>
<span id="cb38-105"><a href="#cb38-105" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>*Java web token*: An _app_ using a *JWT* creates a new service account, which</span>
<span id="cb38-106"><a href="#cb38-106" aria-hidden="true" tabindex="-1"></a>can only access files and folders that have been explicitly shared with it. </span>
<span id="cb38-107"><a href="#cb38-107" aria-hidden="true" tabindex="-1"></a>(See below for an example). This allows for more granular access control and is</span>
<span id="cb38-108"><a href="#cb38-108" aria-hidden="true" tabindex="-1"></a>my method of choice for unsupervised dashboards or other automation tasks.</span>
<span id="cb38-109"><a href="#cb38-109" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>*Client Credentials Grant*: Finally, apps can use a</span>
<span id="cb38-110"><a href="#cb38-110" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Client Credentials Grant (CCG)</span><span class="co">](https://developer.box.com/platform/authentication-methods/#client-credentials-grant-ccg)</span>,</span>
<span id="cb38-111"><a href="#cb38-111" aria-hidden="true" tabindex="-1"></a>but that's not something I have explored, yet.</span>
<span id="cb38-112"><a href="#cb38-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-113"><a href="#cb38-113" aria-hidden="true" tabindex="-1"></a>In this walkthrough, I will set up two _Custom Apps_, one using</span>
<span id="cb38-114"><a href="#cb38-114" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">OAuth 2.0</span><span class="co">](https://auth0.com/intro-to-iam/what-is-oauth-2)</span> </span>
<span id="cb38-115"><a href="#cb38-115" aria-hidden="true" tabindex="-1"></a>and another using a </span>
<span id="cb38-116"><a href="#cb38-116" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">JSON Web Token (JWT)</span><span class="co">](https://en.wikipedia.org/wiki/JSON_Web_Token)</span></span>
<span id="cb38-117"><a href="#cb38-117" aria-hidden="true" tabindex="-1"></a>for authentication.</span>
<span id="cb38-118"><a href="#cb38-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-119"><a href="#cb38-119" aria-hidden="true" tabindex="-1"></a><span class="fu">## Using OAuth2 for authentication</span></span>
<span id="cb38-120"><a href="#cb38-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-121"><a href="#cb38-121" aria-hidden="true" tabindex="-1"></a><span class="fu">### Creating a new app: r_oauth</span></span>
<span id="cb38-122"><a href="#cb38-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-123"><a href="#cb38-123" aria-hidden="true" tabindex="-1"></a>If you want to connect to box computationally, you need to create an _app_ that</span>
<span id="cb38-124"><a href="#cb38-124" aria-hidden="true" tabindex="-1"></a>governs how you interact with the box API. The following instructions assume</span>
<span id="cb38-125"><a href="#cb38-125" aria-hidden="true" tabindex="-1"></a>that you don't have any apps, yet, so I will create one from scratch.</span>
<span id="cb38-126"><a href="#cb38-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-127"><a href="#cb38-127" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Log into the <span class="co">[</span><span class="ot">box developer console</span><span class="co">](https://app.box.com/developers/console)</span>,</span>
<span id="cb38-128"><a href="#cb38-128" aria-hidden="true" tabindex="-1"></a>  with your usual box username &amp; password.</span>
<span id="cb38-129"><a href="#cb38-129" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If this is the first app you are creating, you will be presented with three</span>
<span id="cb38-130"><a href="#cb38-130" aria-hidden="true" tabindex="-1"></a> choices. For my purposes, a <span class="in">`Custom App`</span> is the best choice. (If you already</span>
<span id="cb38-131"><a href="#cb38-131" aria-hidden="true" tabindex="-1"></a> created at least one app before, you will see it listed, and can use the </span>
<span id="cb38-132"><a href="#cb38-132" aria-hidden="true" tabindex="-1"></a> <span class="in">`Create Platform App`</span> button on the upper right instead, see the JWT section</span>
<span id="cb38-133"><a href="#cb38-133" aria-hidden="true" tabindex="-1"></a> below where I create a second app, below.)</span>
<span id="cb38-134"><a href="#cb38-134" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb38-135"><a href="#cb38-135" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb38-136"><a href="#cb38-136" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb38-137"><a href="#cb38-137" aria-hidden="true" tabindex="-1"></a><span class="fu">### Screenshot</span></span>
<span id="cb38-138"><a href="#cb38-138" aria-hidden="true" tabindex="-1"></a><span class="al">![](screenshots/create_app.jpg)</span>{#fig-create_app}</span>
<span id="cb38-139"><a href="#cb38-139" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb38-140"><a href="#cb38-140" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Next, I choose a suitable name for the app (e.g. <span class="in">`r_oauth`</span>), and add a brief</span>
<span id="cb38-141"><a href="#cb38-141" aria-hidden="true" tabindex="-1"></a>  description before clicking the <span class="in">`Next`</span> button.</span>
<span id="cb38-142"><a href="#cb38-142" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-143"><a href="#cb38-143" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb38-144"><a href="#cb38-144" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-145"><a href="#cb38-145" aria-hidden="true" tabindex="-1"></a><span class="fu">### Screenshots </span></span>
<span id="cb38-146"><a href="#cb38-146" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-147"><a href="#cb38-147" aria-hidden="true" tabindex="-1"></a>:::: {layout-ncol=2}</span>
<span id="cb38-148"><a href="#cb38-148" aria-hidden="true" tabindex="-1"></a><span class="al">![](screenshots/custom_app_1.jpg)</span>{#fig-custom_app_1}</span>
<span id="cb38-149"><a href="#cb38-149" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-150"><a href="#cb38-150" aria-hidden="true" tabindex="-1"></a><span class="al">![](screenshots/custom_app_2.jpg)</span>{#fig-custom_app_2}</span>
<span id="cb38-151"><a href="#cb38-151" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb38-152"><a href="#cb38-152" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb38-153"><a href="#cb38-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-154"><a href="#cb38-154" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>On the second page of the modal, I pick <span class="in">`User Authentication (OAuth 2.0)`</span> as</span>
<span id="cb38-155"><a href="#cb38-155" aria-hidden="true" tabindex="-1"></a>  the authentication method and then hit the <span class="in">`Create App`</span> button.</span>
<span id="cb38-156"><a href="#cb38-156" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>This takes me to main configuration page of my new <span class="in">`r_oauth`</span> app. </span>
<span id="cb38-157"><a href="#cb38-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-158"><a href="#cb38-158" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb38-159"><a href="#cb38-159" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb38-160"><a href="#cb38-160" aria-hidden="true" tabindex="-1"></a><span class="fu">### Screenshot</span></span>
<span id="cb38-161"><a href="#cb38-161" aria-hidden="true" tabindex="-1"></a><span class="al">![](screenshots/app_config.jpg)</span>{#fig-app_config.jpg}</span>
<span id="cb38-162"><a href="#cb38-162" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb38-163"><a href="#cb38-163" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-164"><a href="#cb38-164" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The <span class="in">`Configuration`</span> tab includes the </span>
<span id="cb38-165"><a href="#cb38-165" aria-hidden="true" tabindex="-1"></a>  <span class="in">`OAuth 2.0 Credentials`</span> section that provides me with the <span class="in">`Client ID`</span> and</span>
<span id="cb38-166"><a href="#cb38-166" aria-hidden="true" tabindex="-1"></a>  the <span class="in">`Client Secret`</span> strings, which are used in the same way as my <span class="in">`username`</span></span>
<span id="cb38-167"><a href="#cb38-167" aria-hidden="true" tabindex="-1"></a>  and <span class="in">`password`</span> for my box account. (So I will keep the secret and not share</span>
<span id="cb38-168"><a href="#cb38-168" aria-hidden="true" tabindex="-1"></a>  them with anybody!)</span>
<span id="cb38-169"><a href="#cb38-169" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>I can invalidate my current ID / Secret pair and obtain a new set any time</span>
<span id="cb38-170"><a href="#cb38-170" aria-hidden="true" tabindex="-1"></a>    by clicking on the <span class="in">`Reset`</span> button.</span>
<span id="cb38-171"><a href="#cb38-171" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Next, I scroll down to the <span class="in">`OAuth 2.0 Redirect URI`</span> section of the page,</span>
<span id="cb38-172"><a href="#cb38-172" aria-hidden="true" tabindex="-1"></a>  paste <span class="in">`http://localhost:1410/`</span> into the <span class="in">`Redirect URI`</span> text box and then</span>
<span id="cb38-173"><a href="#cb38-173" aria-hidden="true" tabindex="-1"></a>  hit the blue <span class="in">`Add`</span> button. The new URI is now shown below the text box.</span>
<span id="cb38-174"><a href="#cb38-174" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-175"><a href="#cb38-175" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb38-176"><a href="#cb38-176" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb38-177"><a href="#cb38-177" aria-hidden="true" tabindex="-1"></a><span class="fu">### Screenshot</span></span>
<span id="cb38-178"><a href="#cb38-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-179"><a href="#cb38-179" aria-hidden="true" tabindex="-1"></a><span class="al">![](screenshots/redirect.jpg)</span>{#fig-redirect}</span>
<span id="cb38-180"><a href="#cb38-180" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb38-181"><a href="#cb38-181" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-182"><a href="#cb38-182" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Finally, I scroll down further to the <span class="in">`Application Scopes`</span> section. By </span>
<span id="cb38-183"><a href="#cb38-183" aria-hidden="true" tabindex="-1"></a>  default, my app only has the <span class="in">`Read all files and folders in Box`</span> box ticked,</span>
<span id="cb38-184"><a href="#cb38-184" aria-hidden="true" tabindex="-1"></a>  providing read-only access. Because I also want to be able to write files and</span>
<span id="cb38-185"><a href="#cb38-185" aria-hidden="true" tabindex="-1"></a>  create folders, I also check the <span class="in">`Write all files and folders in Box`</span> option.</span>
<span id="cb38-186"><a href="#cb38-186" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-187"><a href="#cb38-187" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb38-188"><a href="#cb38-188" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb38-189"><a href="#cb38-189" aria-hidden="true" tabindex="-1"></a><span class="fu">### Screenshot</span></span>
<span id="cb38-190"><a href="#cb38-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-191"><a href="#cb38-191" aria-hidden="true" tabindex="-1"></a><span class="al">![](screenshots/write_access.jpg)</span>{#fig-write_access}</span>
<span id="cb38-192"><a href="#cb38-192" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb38-193"><a href="#cb38-193" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-194"><a href="#cb38-194" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning}</span>
<span id="cb38-195"><a href="#cb38-195" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-196"><a href="#cb38-196" aria-hidden="true" tabindex="-1"></a><span class="fu">### $ operator is invalid for atomic vectors</span></span>
<span id="cb38-197"><a href="#cb38-197" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-198"><a href="#cb38-198" aria-hidden="true" tabindex="-1"></a>If I forget to grant write access to box, operations that try to modify</span>
<span id="cb38-199"><a href="#cb38-199" aria-hidden="true" tabindex="-1"></a>files or folders fail with the <span class="in">`$ operator is invalid for atomic vectors`</span></span>
<span id="cb38-200"><a href="#cb38-200" aria-hidden="true" tabindex="-1"></a>error message.</span>
<span id="cb38-201"><a href="#cb38-201" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb38-202"><a href="#cb38-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-203"><a href="#cb38-203" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>To make these change permanent, I click the <span class="in">`Save Changes`</span> button at the</span>
<span id="cb38-204"><a href="#cb38-204" aria-hidden="true" tabindex="-1"></a>  top of the Configuration page.</span>
<span id="cb38-205"><a href="#cb38-205" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-206"><a href="#cb38-206" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>I keep this configuration page open, so I can refer back to it below.</span>
<span id="cb38-207"><a href="#cb38-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-208"><a href="#cb38-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-209"><a href="#cb38-209" aria-hidden="true" tabindex="-1"></a><span class="fu">### Authenticating</span></span>
<span id="cb38-210"><a href="#cb38-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-211"><a href="#cb38-211" aria-hidden="true" tabindex="-1"></a>Let's start by accessing my box account from within R on my local system, e.g.</span>
<span id="cb38-212"><a href="#cb38-212" aria-hidden="true" tabindex="-1"></a>where I can open a web browser to complete the authentication process.</span>
<span id="cb38-213"><a href="#cb38-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-214"><a href="#cb38-214" aria-hidden="true" tabindex="-1"></a>First, I install the <span class="in">`boxr`</span> package, which is </span>
<span id="cb38-215"><a href="#cb38-215" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">available from CRAN</span><span class="co">](https://cran.r-project.org/package=boxr)</span>.</span>
<span id="cb38-216"><a href="#cb38-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-219"><a href="#cb38-219" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-220"><a href="#cb38-220" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb38-221"><a href="#cb38-221" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"boxr"</span>)</span>
<span id="cb38-222"><a href="#cb38-222" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-223"><a href="#cb38-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-224"><a href="#cb38-224" aria-hidden="true" tabindex="-1"></a>Next, I attach the package to my R session and use the <span class="in">`box_auth()`</span> function to</span>
<span id="cb38-225"><a href="#cb38-225" aria-hidden="true" tabindex="-1"></a>authenticate with the <span class="in">`r_oauth`</span> app I created above. </span>
<span id="cb38-226"><a href="#cb38-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-229"><a href="#cb38-229" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-230"><a href="#cb38-230" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boxr)</span>
<span id="cb38-231"><a href="#cb38-231" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">boxr.progress =</span> <span class="cn">FALSE</span>, <span class="at">boxr.verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb38-232"><a href="#cb38-232" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-233"><a href="#cb38-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-234"><a href="#cb38-234" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip collapse="true"}</span>
<span id="cb38-235"><a href="#cb38-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-236"><a href="#cb38-236" aria-hidden="true" tabindex="-1"></a><span class="fu">### boxr options</span></span>
<span id="cb38-237"><a href="#cb38-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-238"><a href="#cb38-238" aria-hidden="true" tabindex="-1"></a>I can fine tune the behavior of the <span class="in">`boxr`</span> package through different</span>
<span id="cb38-239"><a href="#cb38-239" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">options</span><span class="co">](https://ijlyttle.github.io/boxr/reference/boxr_options.html)</span>.</span>
<span id="cb38-240"><a href="#cb38-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-243"><a href="#cb38-243" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-244"><a href="#cb38-244" aria-hidden="true" tabindex="-1"></a><span class="fu">boxr_options</span>()</span>
<span id="cb38-245"><a href="#cb38-245" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-246"><a href="#cb38-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-247"><a href="#cb38-247" aria-hidden="true" tabindex="-1"></a>For this tutorial, I switch off the progress bar and suppress messages with</span>
<span id="cb38-248"><a href="#cb38-248" aria-hidden="true" tabindex="-1"></a>by setting the <span class="in">`boxr.progress`</span> and <span class="in">`boxr.verbose`</span> options to <span class="in">`FALSE`</span>.</span>
<span id="cb38-249"><a href="#cb38-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-250"><a href="#cb38-250" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb38-251"><a href="#cb38-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-252"><a href="#cb38-252" aria-hidden="true" tabindex="-1"></a><span class="fu">### Environmental variables</span></span>
<span id="cb38-253"><a href="#cb38-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-254"><a href="#cb38-254" aria-hidden="true" tabindex="-1"></a>To communicate the <span class="in">`Client ID`</span> and <span class="in">`Client Secret`</span> information shown in the </span>
<span id="cb38-255"><a href="#cb38-255" aria-hidden="true" tabindex="-1"></a><span class="in">`Configuration -&gt; OAuth 2.0 Credentials`</span> section of</span>
<span id="cb38-256"><a href="#cb38-256" aria-hidden="true" tabindex="-1"></a>my app's configuration page (see above), I expose them as environmental </span>
<span id="cb38-257"><a href="#cb38-257" aria-hidden="true" tabindex="-1"></a>variables.</span>
<span id="cb38-258"><a href="#cb38-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-259"><a href="#cb38-259" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb38-260"><a href="#cb38-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-261"><a href="#cb38-261" aria-hidden="true" tabindex="-1"></a>The Client ID and Client Secret strings shown in this tutorial are no</span>
<span id="cb38-262"><a href="#cb38-262" aria-hidden="true" tabindex="-1"></a>longer valid, so please replace them with your own to follow along.</span>
<span id="cb38-263"><a href="#cb38-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-264"><a href="#cb38-264" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb38-265"><a href="#cb38-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-268"><a href="#cb38-268" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-269"><a href="#cb38-269" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.setenv</span>(<span class="at">BOX_CLIENT_ID=</span><span class="st">"0o5h6s0mey2l5f6l89bkjrmk42vjv9g2"</span>)</span>
<span id="cb38-270"><a href="#cb38-270" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.setenv</span>(<span class="at">BOX_CLIENT_SECRET=</span><span class="st">"Zfv4UX5Fi2rQAK9Cskcf3RgtFlptrH2c"</span>)</span>
<span id="cb38-271"><a href="#cb38-271" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-272"><a href="#cb38-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-273"><a href="#cb38-273" aria-hidden="true" tabindex="-1"></a>Usually, I add the <span class="in">`BOX_CLIENT_ID`</span> and <span class="in">`BOX_CLIENT_SECRET`</span> to my <span class="in">`.Renviron`</span></span>
<span id="cb38-274"><a href="#cb38-274" aria-hidden="true" tabindex="-1"></a>file instead of specifying them via <span class="in">`Sys.setenv()`</span>. That way, <span class="in">`box_auth()`</span> will</span>
<span id="cb38-275"><a href="#cb38-275" aria-hidden="true" tabindex="-1"></a>use them automatically next time and avoid including any credentials</span>
<span id="cb38-276"><a href="#cb38-276" aria-hidden="true" tabindex="-1"></a>in my analysis code.</span>
<span id="cb38-277"><a href="#cb38-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-280"><a href="#cb38-280" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-281"><a href="#cb38-281" aria-hidden="true" tabindex="-1"></a>boxr<span class="sc">::</span><span class="fu">box_auth</span>()</span>
<span id="cb38-282"><a href="#cb38-282" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-283"><a href="#cb38-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-284"><a href="#cb38-284" aria-hidden="true" tabindex="-1"></a>Providing the <span class="in">`BOX_CLIENT_ID`</span> and <span class="in">`BOX_CLIENT_SECRET`</span> strings is not sufficient</span>
<span id="cb38-285"><a href="#cb38-285" aria-hidden="true" tabindex="-1"></a>to gain access to my box account, though. To complete the OAuth 2.0 hand-shake, </span>
<span id="cb38-286"><a href="#cb38-286" aria-hidden="true" tabindex="-1"></a>I am now directed to a website, which opens in my default web browser, where I </span>
<span id="cb38-287"><a href="#cb38-287" aria-hidden="true" tabindex="-1"></a>can log into my box account interactively (using my usual username and</span>
<span id="cb38-288"><a href="#cb38-288" aria-hidden="true" tabindex="-1"></a>password). Afterward, I confirm that I want to grant my <span class="in">`r_oauth`</span> app access to </span>
<span id="cb38-289"><a href="#cb38-289" aria-hidden="true" tabindex="-1"></a>my files on my behalf.</span>
<span id="cb38-290"><a href="#cb38-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-291"><a href="#cb38-291" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb38-292"><a href="#cb38-292" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb38-293"><a href="#cb38-293" aria-hidden="true" tabindex="-1"></a><span class="fu">### Screenshots</span></span>
<span id="cb38-294"><a href="#cb38-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-295"><a href="#cb38-295" aria-hidden="true" tabindex="-1"></a>:::: {layout-ncol=2}</span>
<span id="cb38-296"><a href="#cb38-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-297"><a href="#cb38-297" aria-hidden="true" tabindex="-1"></a><span class="al">![](screenshots/login.jpg)</span>{#fig-login}</span>
<span id="cb38-298"><a href="#cb38-298" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-299"><a href="#cb38-299" aria-hidden="true" tabindex="-1"></a><span class="al">![](screenshots/grant_access.jpg)</span>{#fig-grant_access}</span>
<span id="cb38-300"><a href="#cb38-300" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb38-301"><a href="#cb38-301" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb38-302"><a href="#cb38-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-303"><a href="#cb38-303" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb38-304"><a href="#cb38-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-305"><a href="#cb38-305" aria-hidden="true" tabindex="-1"></a>A call to <span class="in">`box_auth()`</span> is required every time I want to interact with box</span>
<span id="cb38-306"><a href="#cb38-306" aria-hidden="true" tabindex="-1"></a>in an R session, e.g. I include the following two lines at the top of each of</span>
<span id="cb38-307"><a href="#cb38-307" aria-hidden="true" tabindex="-1"></a>my R markdown / quarto documents:</span>
<span id="cb38-308"><a href="#cb38-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-309"><a href="#cb38-309" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-310"><a href="#cb38-310" aria-hidden="true" tabindex="-1"></a><span class="in">library(boxr)</span></span>
<span id="cb38-311"><a href="#cb38-311" aria-hidden="true" tabindex="-1"></a><span class="in">box_auth()</span></span>
<span id="cb38-312"><a href="#cb38-312" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-313"><a href="#cb38-313" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb38-314"><a href="#cb38-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-315"><a href="#cb38-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-316"><a href="#cb38-316" aria-hidden="true" tabindex="-1"></a><span class="fu">### The cache file</span></span>
<span id="cb38-317"><a href="#cb38-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-318"><a href="#cb38-318" aria-hidden="true" tabindex="-1"></a>When <span class="in">`box_auth()`</span> runs successfully for the first time, it creates a</span>
<span id="cb38-319"><a href="#cb38-319" aria-hidden="true" tabindex="-1"></a>cache file (by default as the hidden <span class="in">`~/.box-oauth`</span> file in my home </span>
<span id="cb38-320"><a href="#cb38-320" aria-hidden="true" tabindex="-1"></a>directory)<span class="ot">[^2]</span>. The next call to <span class="in">`box_auth()`</span> will refresh the information</span>
<span id="cb38-321"><a href="#cb38-321" aria-hidden="true" tabindex="-1"></a>stored in the cache file instead of prompting me to sign in via the box</span>
<span id="cb38-322"><a href="#cb38-322" aria-hidden="true" tabindex="-1"></a>website again.</span>
<span id="cb38-323"><a href="#cb38-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-326"><a href="#cb38-326" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-327"><a href="#cb38-327" aria-hidden="true" tabindex="-1"></a><span class="fu">file.info</span>(<span class="st">"~/.boxr-oauth"</span>)[, <span class="fu">c</span>(<span class="st">"size"</span>, <span class="st">"mode"</span>, <span class="st">"mtime"</span>, <span class="st">"ctime"</span>)]</span>
<span id="cb38-328"><a href="#cb38-328" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-329"><a href="#cb38-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-330"><a href="#cb38-330" aria-hidden="true" tabindex="-1"></a><span class="ot">[^2]: </span>To create cache file under a different path, I could specify it's location</span>
<span id="cb38-331"><a href="#cb38-331" aria-hidden="true" tabindex="-1"></a>via the <span class="in">`cache`</span> argument of the <span class="in">`box_auth()`</span> function. For example, I could</span>
<span id="cb38-332"><a href="#cb38-332" aria-hidden="true" tabindex="-1"></a>point to a network drive that is accessible at the same path from different</span>
<span id="cb38-333"><a href="#cb38-333" aria-hidden="true" tabindex="-1"></a>computers.</span>
<span id="cb38-334"><a href="#cb38-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-335"><a href="#cb38-335" aria-hidden="true" tabindex="-1"></a><span class="fu">### Writing and reading files from box</span></span>
<span id="cb38-336"><a href="#cb38-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-337"><a href="#cb38-337" aria-hidden="true" tabindex="-1"></a>Now that I have authenticated with my <span class="in">`r_oauth`</span> app, I can browse the folders</span>
<span id="cb38-338"><a href="#cb38-338" aria-hidden="true" tabindex="-1"></a>and files available to me on box. The <span class="in">`box_getwd()`</span> function confirms that</span>
<span id="cb38-339"><a href="#cb38-339" aria-hidden="true" tabindex="-1"></a>I am looking at the root directory of my box account, which has the directory ID</span>
<span id="cb38-340"><a href="#cb38-340" aria-hidden="true" tabindex="-1"></a><span class="in">`0`</span>:</span>
<span id="cb38-341"><a href="#cb38-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-344"><a href="#cb38-344" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-345"><a href="#cb38-345" aria-hidden="true" tabindex="-1"></a>boxr<span class="sc">::</span><span class="fu">box_getwd</span>()</span>
<span id="cb38-346"><a href="#cb38-346" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-347"><a href="#cb38-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-348"><a href="#cb38-348" aria-hidden="true" tabindex="-1"></a>The <span class="in">`box_ls`</span> function returns a <span class="co">[</span><span class="ot">boxr_object_list S3 object</span><span class="co">](https://github.com/r-box/boxr/blob/31d2e7407cc0e6a31a9853fb43f27c48055eb057/R/boxr_s3_classes.R#L27)</span></span>
<span id="cb38-349"><a href="#cb38-349" aria-hidden="true" tabindex="-1"></a>with all objects that are stored in the location specified by the <span class="in">`dir_id`</span></span>
<span id="cb38-350"><a href="#cb38-350" aria-hidden="true" tabindex="-1"></a>argument. It can be coerced into a data.frame, e.g. to filter the output with</span>
<span id="cb38-351"><a href="#cb38-351" aria-hidden="true" tabindex="-1"></a>verbs from the </span>
<span id="cb38-352"><a href="#cb38-352" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">dplyr</span><span class="co">](https://cran.r-project.org/package=dplyr)</span> or</span>
<span id="cb38-353"><a href="#cb38-353" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">poorman</span><span class="co">](https://cran.r-project.org/package=poorman)</span></span>
<span id="cb38-354"><a href="#cb38-354" aria-hidden="true" tabindex="-1"></a>R packages.</span>
<span id="cb38-355"><a href="#cb38-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-358"><a href="#cb38-358" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-359"><a href="#cb38-359" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb38-360"><a href="#cb38-360" aria-hidden="true" tabindex="-1"></a>objects <span class="ot">&lt;-</span> boxr<span class="sc">::</span><span class="fu">box_ls</span>(<span class="at">dir_id =</span> <span class="fu">box_getwd</span>())</span>
<span id="cb38-361"><a href="#cb38-361" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(objects)</span>
<span id="cb38-362"><a href="#cb38-362" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-363"><a href="#cb38-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-364"><a href="#cb38-364" aria-hidden="true" tabindex="-1"></a><span class="ot">[^3]: </span>The <span class="in">`dir_id`</span> defaults to the output of <span class="in">`box_getwd()`</span> and I only</span>
<span id="cb38-365"><a href="#cb38-365" aria-hidden="true" tabindex="-1"></a>specify it here explicitly to highlight that this argument is available. And</span>
<span id="cb38-366"><a href="#cb38-366" aria-hidden="true" tabindex="-1"></a>yes, there is also a <span class="in">`box_setwd()`</span> function to set the remote working directory.</span>
<span id="cb38-367"><a href="#cb38-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-368"><a href="#cb38-368" aria-hidden="true" tabindex="-1"></a>Right now, there is a single folder <span class="in">`tutorial`</span> in my box account<span class="ot">[^3]</span>. Its unique</span>
<span id="cb38-369"><a href="#cb38-369" aria-hidden="true" tabindex="-1"></a>identifier is shown in the <span class="in">`id`</span> column and I can refer to objects in my box</span>
<span id="cb38-370"><a href="#cb38-370" aria-hidden="true" tabindex="-1"></a>account (both folders and files) using this identifier.</span>
<span id="cb38-371"><a href="#cb38-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-374"><a href="#cb38-374" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-375"><a href="#cb38-375" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(objects)</span>
<span id="cb38-376"><a href="#cb38-376" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-377"><a href="#cb38-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-378"><a href="#cb38-378" aria-hidden="true" tabindex="-1"></a>I extract the unique identifier of the <span class="in">`tutorial`</span> folder, so I can refer to</span>
<span id="cb38-379"><a href="#cb38-379" aria-hidden="true" tabindex="-1"></a>it downstream:</span>
<span id="cb38-380"><a href="#cb38-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-383"><a href="#cb38-383" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-384"><a href="#cb38-384" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(poorman))</span>
<span id="cb38-385"><a href="#cb38-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-386"><a href="#cb38-386" aria-hidden="true" tabindex="-1"></a>folder_id <span class="ot">&lt;-</span> objects <span class="sc">|&gt;</span></span>
<span id="cb38-387"><a href="#cb38-387" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb38-388"><a href="#cb38-388" aria-hidden="true" tabindex="-1"></a>  poorman<span class="sc">::</span><span class="fu">filter</span>(name <span class="sc">==</span> <span class="st">"tutorial"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb38-389"><a href="#cb38-389" aria-hidden="true" tabindex="-1"></a>  poorman<span class="sc">::</span><span class="fu">pull</span>(<span class="st">"id"</span>)</span>
<span id="cb38-390"><a href="#cb38-390" aria-hidden="true" tabindex="-1"></a>folder_id</span>
<span id="cb38-391"><a href="#cb38-391" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-392"><a href="#cb38-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-393"><a href="#cb38-393" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb38-394"><a href="#cb38-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-395"><a href="#cb38-395" aria-hidden="true" tabindex="-1"></a>Alternatively, I can also copy this identifier from the end of the URL that is</span>
<span id="cb38-396"><a href="#cb38-396" aria-hidden="true" tabindex="-1"></a>showin in my web browser when I open the <span class="in">`tutorial`</span> folder. Similarly pasting</span>
<span id="cb38-397"><a href="#cb38-397" aria-hidden="true" tabindex="-1"></a>the URL </span>
<span id="cb38-398"><a href="#cb38-398" aria-hidden="true" tabindex="-1"></a><span class="in">`r paste0("https://app.box.com/folder/", folder_id)`</span> </span>
<span id="cb38-399"><a href="#cb38-399" aria-hidden="true" tabindex="-1"></a>into a web browser opens my <span class="in">`tutorial`</span> folder there.</span>
<span id="cb38-400"><a href="#cb38-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-401"><a href="#cb38-401" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb38-402"><a href="#cb38-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-403"><a href="#cb38-403" aria-hidden="true" tabindex="-1"></a>So let's store a copy of the <span class="in">`mtcars`</span> dataset included in R's <span class="in">`dataset`</span> package</span>
<span id="cb38-404"><a href="#cb38-404" aria-hidden="true" tabindex="-1"></a>as a CSV file in the <span class="in">`tutorials`</span> folder (specified by its id, see above). </span>
<span id="cb38-405"><a href="#cb38-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-408"><a href="#cb38-408" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-409"><a href="#cb38-409" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb38-410"><a href="#cb38-410" aria-hidden="true" tabindex="-1"></a>boxr<span class="sc">::</span><span class="fu">box_write</span>(<span class="at">object =</span> mtcars, <span class="at">file_name =</span> <span class="st">"mtcars.csv"</span>, <span class="at">dir_id =</span> folder_id)</span>
<span id="cb38-411"><a href="#cb38-411" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-412"><a href="#cb38-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-413"><a href="#cb38-413" aria-hidden="true" tabindex="-1"></a>To verify the successful upload, I can list the contents of the <span class="in">`tutorial`</span></span>
<span id="cb38-414"><a href="#cb38-414" aria-hidden="true" tabindex="-1"></a>folder:</span>
<span id="cb38-415"><a href="#cb38-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-418"><a href="#cb38-418" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-419"><a href="#cb38-419" aria-hidden="true" tabindex="-1"></a>boxr<span class="sc">::</span><span class="fu">box_ls</span>(<span class="at">dir_id =</span> folder_id) <span class="sc">|&gt;</span></span>
<span id="cb38-420"><a href="#cb38-420" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb38-421"><a href="#cb38-421" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-422"><a href="#cb38-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-423"><a href="#cb38-423" aria-hidden="true" tabindex="-1"></a>To read the file into my R session, I extract the CSV file's id and </span>
<span id="cb38-424"><a href="#cb38-424" aria-hidden="true" tabindex="-1"></a>pass it to the <span class="in">`box_read_csv`</span> function:</span>
<span id="cb38-425"><a href="#cb38-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-428"><a href="#cb38-428" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-429"><a href="#cb38-429" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb38-430"><a href="#cb38-430" aria-hidden="true" tabindex="-1"></a>file_id <span class="ot">&lt;-</span> boxr<span class="sc">::</span><span class="fu">box_ls</span>(<span class="at">dir_id =</span> folder_id) <span class="sc">|&gt;</span></span>
<span id="cb38-431"><a href="#cb38-431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb38-432"><a href="#cb38-432" aria-hidden="true" tabindex="-1"></a>  poorman<span class="sc">::</span><span class="fu">filter</span>(name <span class="sc">==</span> <span class="st">"mtcars.csv"</span>) <span class="sc">|&gt;</span></span>
<span id="cb38-433"><a href="#cb38-433" aria-hidden="true" tabindex="-1"></a>  poorman<span class="sc">::</span><span class="fu">pull</span>(id)</span>
<span id="cb38-434"><a href="#cb38-434" aria-hidden="true" tabindex="-1"></a>boxr<span class="sc">::</span><span class="fu">box_read_csv</span>(file_id) <span class="sc">|&gt;</span></span>
<span id="cb38-435"><a href="#cb38-435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span>
<span id="cb38-436"><a href="#cb38-436" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-437"><a href="#cb38-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-438"><a href="#cb38-438" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip collapse="false"}</span>
<span id="cb38-439"><a href="#cb38-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-440"><a href="#cb38-440" aria-hidden="true" tabindex="-1"></a><span class="fu">### Functions to interact with files stored in box</span></span>
<span id="cb38-441"><a href="#cb38-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-442"><a href="#cb38-442" aria-hidden="true" tabindex="-1"></a>The <span class="in">`boxr`</span> packages offers </span>
<span id="cb38-443"><a href="#cb38-443" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">convenience functions</span><span class="co">](https://r-box.github.io/boxr/reference/index.html)</span> </span>
<span id="cb38-444"><a href="#cb38-444" aria-hidden="true" tabindex="-1"></a>for different file types, e.g.</span>
<span id="cb38-445"><a href="#cb38-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-446"><a href="#cb38-446" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">box_write()</span><span class="co">](https://r-box.github.io/boxr/reference/box_write.html)</span></span>
<span id="cb38-447"><a href="#cb38-447" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">box_save_rds()</span><span class="co">](https://r-box.github.io/boxr/reference/box_save_rds.html)</span></span>
<span id="cb38-448"><a href="#cb38-448" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">box_save()</span><span class="co">](https://r-box.github.io/boxr/reference/box_save.html)</span></span>
<span id="cb38-449"><a href="#cb38-449" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">box_read_csv()</span><span class="co">](https://r-box.github.io/boxr/reference/box_read_csv.html)</span></span>
<span id="cb38-450"><a href="#cb38-450" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">box_read_tsv()</span><span class="co">](https://r-box.github.io/boxr/reference/box_read_tsv.html)</span></span>
<span id="cb38-451"><a href="#cb38-451" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">box_read_json()</span><span class="co">](https://r-box.github.io/boxr/reference/box_read_json.html)</span></span>
<span id="cb38-452"><a href="#cb38-452" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">box_read_excel()</span><span class="co">](https://r-box.github.io/boxr/reference/box_read_excel.html)</span></span>
<span id="cb38-453"><a href="#cb38-453" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">box_read_rds()</span><span class="co">](https://r-box.github.io/boxr/reference/box_read_rds.html)</span></span>
<span id="cb38-454"><a href="#cb38-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-455"><a href="#cb38-455" aria-hidden="true" tabindex="-1"></a>The <span class="in">`box_write`</span> and <span class="in">`box_read`</span> functions allow me to specify the</span>
<span id="cb38-456"><a href="#cb38-456" aria-hidden="true" tabindex="-1"></a>function that write / reads the file myself via the <span class="in">`write_fun`</span> and <span class="in">`read_fun`</span></span>
<span id="cb38-457"><a href="#cb38-457" aria-hidden="true" tabindex="-1"></a>arguments, respectively.</span>
<span id="cb38-458"><a href="#cb38-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-459"><a href="#cb38-459" aria-hidden="true" tabindex="-1"></a>To simply copy files from / to box without reading them, I can use the </span>
<span id="cb38-460"><a href="#cb38-460" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">box_dl()</span><span class="co">](https://r-box.github.io/boxr/reference/box_dl.html)</span></span>
<span id="cb38-461"><a href="#cb38-461" aria-hidden="true" tabindex="-1"></a>and</span>
<span id="cb38-462"><a href="#cb38-462" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">box_ul()</span><span class="co">](https://r-box.github.io/boxr/reference/box_ul.html)</span>,</span>
<span id="cb38-463"><a href="#cb38-463" aria-hidden="true" tabindex="-1"></a>respectively.</span>
<span id="cb38-464"><a href="#cb38-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-465"><a href="#cb38-465" aria-hidden="true" tabindex="-1"></a>Finally, I can also move the file into the trash (from which it will be </span>
<span id="cb38-466"><a href="#cb38-466" aria-hidden="true" tabindex="-1"></a>automatically removed after one month) with the</span>
<span id="cb38-467"><a href="#cb38-467" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">box_delete_file()</span><span class="co">](https://r-box.github.io/boxr/reference/box_delete_file.html)</span></span>
<span id="cb38-468"><a href="#cb38-468" aria-hidden="true" tabindex="-1"></a>function.</span>
<span id="cb38-469"><a href="#cb38-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-470"><a href="#cb38-470" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb38-471"><a href="#cb38-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-472"><a href="#cb38-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-473"><a href="#cb38-473" aria-hidden="true" tabindex="-1"></a>For other functions, e.g. to </span>
<span id="cb38-474"><a href="#cb38-474" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">search the box index</span><span class="co">](https://support.box.com/hc/en-us/articles/360043696314-Search-for-Files-Folders-and-Content)</span>,</span>
<span id="cb38-475"><a href="#cb38-475" aria-hidden="true" tabindex="-1"></a>please refer to the</span>
<span id="cb38-476"><a href="#cb38-476" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">boxr reference</span><span class="co">](https://r-box.github.io/boxr/reference/index.html)</span>.</span>
<span id="cb38-477"><a href="#cb38-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-478"><a href="#cb38-478" aria-hidden="true" tabindex="-1"></a><span class="fu">### Success!</span></span>
<span id="cb38-479"><a href="#cb38-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-480"><a href="#cb38-480" aria-hidden="true" tabindex="-1"></a>Great! Now I have a working _app_ that allows me to interact with folders</span>
<span id="cb38-481"><a href="#cb38-481" aria-hidden="true" tabindex="-1"></a>and files in my box account, all from within the comfort of my R session.</span>
<span id="cb38-482"><a href="#cb38-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-483"><a href="#cb38-483" aria-hidden="true" tabindex="-1"></a><span class="fu">## Using a JSON Web Token for authentication</span></span>
<span id="cb38-484"><a href="#cb38-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-485"><a href="#cb38-485" aria-hidden="true" tabindex="-1"></a>Another way of authenticating a _Custom App_ within box is via a </span>
<span id="cb38-486"><a href="#cb38-486" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">JSON Web Token</span><span class="co">](https://en.wikipedia.org/wiki/JSON_Web_Token)</span>. This requires</span>
<span id="cb38-487"><a href="#cb38-487" aria-hidden="true" tabindex="-1"></a>that the </span>
<span id="cb38-488"><a href="#cb38-488" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">jose R package</span><span class="co">](https://cran.r-project.org/package=jose)</span> </span>
<span id="cb38-489"><a href="#cb38-489" aria-hidden="true" tabindex="-1"></a>is installed on your system:</span>
<span id="cb38-490"><a href="#cb38-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-493"><a href="#cb38-493" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-494"><a href="#cb38-494" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jose)</span>
<span id="cb38-495"><a href="#cb38-495" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-496"><a href="#cb38-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-497"><a href="#cb38-497" aria-hidden="true" tabindex="-1"></a>In this mode, the app authenticates using a signed JWT token, which requires</span>
<span id="cb38-498"><a href="#cb38-498" aria-hidden="true" tabindex="-1"></a>a public/private key-pair for added security (see below).</span>
<span id="cb38-499"><a href="#cb38-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-500"><a href="#cb38-500" aria-hidden="true" tabindex="-1"></a>To authenticate via this route, I need to create another app in my</span>
<span id="cb38-501"><a href="#cb38-501" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">box developer console</span><span class="co">](https://app.box.com/developers/console)</span>. Because I</span>
<span id="cb38-502"><a href="#cb38-502" aria-hidden="true" tabindex="-1"></a>already created a first app (see above), the console's home screen now looks</span>
<span id="cb38-503"><a href="#cb38-503" aria-hidden="true" tabindex="-1"></a>different, listing my <span class="in">`r_oauth`</span> app. To add another app, I click the blue </span>
<span id="cb38-504"><a href="#cb38-504" aria-hidden="true" tabindex="-1"></a><span class="in">`Create Platform App`</span> in the upper right corner of the page.</span>
<span id="cb38-505"><a href="#cb38-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-506"><a href="#cb38-506" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb38-507"><a href="#cb38-507" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb38-508"><a href="#cb38-508" aria-hidden="true" tabindex="-1"></a><span class="fu">### Screenshot</span></span>
<span id="cb38-509"><a href="#cb38-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-510"><a href="#cb38-510" aria-hidden="true" tabindex="-1"></a><span class="al">![](screenshots/second_app.jpg)</span></span>
<span id="cb38-511"><a href="#cb38-511" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb38-512"><a href="#cb38-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-513"><a href="#cb38-513" aria-hidden="true" tabindex="-1"></a>Once again, I choose to create a <span class="in">`Custom App`</span> and pick a unique name for my</span>
<span id="cb38-514"><a href="#cb38-514" aria-hidden="true" tabindex="-1"></a>app, e.g. <span class="in">`r_jwt`</span>. But on the second page of the modal, I now choose</span>
<span id="cb38-515"><a href="#cb38-515" aria-hidden="true" tabindex="-1"></a><span class="in">`Server Authentication (with JWT)`</span> as my authentication method before clicking</span>
<span id="cb38-516"><a href="#cb38-516" aria-hidden="true" tabindex="-1"></a>the <span class="in">`Create App`</span> button.</span>
<span id="cb38-517"><a href="#cb38-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-518"><a href="#cb38-518" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb38-519"><a href="#cb38-519" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb38-520"><a href="#cb38-520" aria-hidden="true" tabindex="-1"></a><span class="fu">### Screenshots</span></span>
<span id="cb38-521"><a href="#cb38-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-522"><a href="#cb38-522" aria-hidden="true" tabindex="-1"></a>:::: {layout-ncol=2}</span>
<span id="cb38-523"><a href="#cb38-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-524"><a href="#cb38-524" aria-hidden="true" tabindex="-1"></a><span class="al">![](screenshots/custom_app_1_jwt.jpg)</span>{#fig-custom_app_1_jwt}</span>
<span id="cb38-525"><a href="#cb38-525" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-526"><a href="#cb38-526" aria-hidden="true" tabindex="-1"></a><span class="al">![](screenshots/custom_app_2_jwt.jpg)</span>{#fig-custom_app_2_jwt}</span>
<span id="cb38-527"><a href="#cb38-527" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb38-528"><a href="#cb38-528" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb38-529"><a href="#cb38-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-530"><a href="#cb38-530" aria-hidden="true" tabindex="-1"></a>Afterwards, I am redirected to the configuration page of my new <span class="in">`r_jwt`</span> app,</span>
<span id="cb38-531"><a href="#cb38-531" aria-hidden="true" tabindex="-1"></a>where I make the following changes:</span>
<span id="cb38-532"><a href="#cb38-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-533"><a href="#cb38-533" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>As in my first example, I allow the app to write / modify files and folders</span>
<span id="cb38-534"><a href="#cb38-534" aria-hidden="true" tabindex="-1"></a>  on my behalf (see @fig-write_access).</span>
<span id="cb38-535"><a href="#cb38-535" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>To make these changes permanent, I click the blue <span class="in">`Save Changes`</span> button on</span>
<span id="cb38-536"><a href="#cb38-536" aria-hidden="true" tabindex="-1"></a>  the upper right of the Configuration page.</span>
<span id="cb38-537"><a href="#cb38-537" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>To use a <span class="in">`JWT`</span> for authentication, I need one more piece of information: an</span>
<span id="cb38-538"><a href="#cb38-538" aria-hidden="true" tabindex="-1"></a>  RSA keypair to sign and authenticate the requests made by my app. I scroll</span>
<span id="cb38-539"><a href="#cb38-539" aria-hidden="true" tabindex="-1"></a>  down to the<span class="in">`Add and Manage Public Keys`</span> section.</span>
<span id="cb38-540"><a href="#cb38-540" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-541"><a href="#cb38-541" aria-hidden="true" tabindex="-1"></a>  There, I use the <span class="in">`Generate a new Public/Private Key pair`</span> button to generate</span>
<span id="cb38-542"><a href="#cb38-542" aria-hidden="true" tabindex="-1"></a>  and download a new key pair for my app.</span>
<span id="cb38-543"><a href="#cb38-543" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-544"><a href="#cb38-544" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb38-545"><a href="#cb38-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-546"><a href="#cb38-546" aria-hidden="true" tabindex="-1"></a><span class="fu">### Screenshot</span></span>
<span id="cb38-547"><a href="#cb38-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-548"><a href="#cb38-548" aria-hidden="true" tabindex="-1"></a><span class="al">![](screenshots/keys.jpg)</span>{#fig-keys}</span>
<span id="cb38-549"><a href="#cb38-549" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb38-550"><a href="#cb38-550" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-551"><a href="#cb38-551" aria-hidden="true" tabindex="-1"></a>  The key information is downloaded in a JSON file with content similar to</span>
<span id="cb38-552"><a href="#cb38-552" aria-hidden="true" tabindex="-1"></a>  this:</span>
<span id="cb38-553"><a href="#cb38-553" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-554"><a href="#cb38-554" aria-hidden="true" tabindex="-1"></a>  <span class="in">```</span></span>
<span id="cb38-555"><a href="#cb38-555" aria-hidden="true" tabindex="-1"></a><span class="in">  {</span></span>
<span id="cb38-556"><a href="#cb38-556" aria-hidden="true" tabindex="-1"></a><span class="in">  "boxAppSettings": {</span></span>
<span id="cb38-557"><a href="#cb38-557" aria-hidden="true" tabindex="-1"></a><span class="in">    "clientID": "jlccq2qe365jy2wo4llm9z9isz9didhv",</span></span>
<span id="cb38-558"><a href="#cb38-558" aria-hidden="true" tabindex="-1"></a><span class="in">    "clientSecret": "VSN5WNe9q4hI2h9PJbppQKsIxm8oxJp8",</span></span>
<span id="cb38-559"><a href="#cb38-559" aria-hidden="true" tabindex="-1"></a><span class="in">    "appAuth": {</span></span>
<span id="cb38-560"><a href="#cb38-560" aria-hidden="true" tabindex="-1"></a><span class="in">      "publicKeyID": "wvslfab2",</span></span>
<span id="cb38-561"><a href="#cb38-561" aria-hidden="true" tabindex="-1"></a><span class="in">      "privateKey": "-----BEGIN ENCRYPTED PRIVATE KEY-----\nMIIFHDBOBgkqhki[TRUNCATED]RvOqeWR1mg==\n-----END ENCRYPTED PRIVATE KEY-----\n",</span></span>
<span id="cb38-562"><a href="#cb38-562" aria-hidden="true" tabindex="-1"></a><span class="in">      "passphrase": "87babeaed61e4ad87309f8063918bd04"</span></span>
<span id="cb38-563"><a href="#cb38-563" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb38-564"><a href="#cb38-564" aria-hidden="true" tabindex="-1"></a><span class="in">  },</span></span>
<span id="cb38-565"><a href="#cb38-565" aria-hidden="true" tabindex="-1"></a><span class="in">  "enterpriseID": "1246725007"</span></span>
<span id="cb38-566"><a href="#cb38-566" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb38-567"><a href="#cb38-567" aria-hidden="true" tabindex="-1"></a><span class="in">  ```</span></span>
<span id="cb38-568"><a href="#cb38-568" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-569"><a href="#cb38-569" aria-hidden="true" tabindex="-1"></a>  This JSON file contains the</span>
<span id="cb38-570"><a href="#cb38-570" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-571"><a href="#cb38-571" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span><span class="in">`clientID`</span>: this unique identifier of the app - I will need it to authorize</span>
<span id="cb38-572"><a href="#cb38-572" aria-hidden="true" tabindex="-1"></a>    my app in the Admin console (see below).</span>
<span id="cb38-573"><a href="#cb38-573" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span><span class="in">`clientSecret`</span>: the secret associated with the <span class="in">`clientID`</span></span>
<span id="cb38-574"><a href="#cb38-574" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span><span class="in">`appAuth`</span>: the public and private RSA key pair, along with their pass phrase</span>
<span id="cb38-575"><a href="#cb38-575" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span><span class="in">`enterpriseID`</span>: the unique identifier of my <span class="in">`enterprise`</span>, e.g. the</span>
<span id="cb38-576"><a href="#cb38-576" aria-hidden="true" tabindex="-1"></a>  organization that manages my box account<span class="ot">[^4]</span>. </span>
<span id="cb38-577"><a href="#cb38-577" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-578"><a href="#cb38-578" aria-hidden="true" tabindex="-1"></a>  <span class="ot">[^4]: </span>Please note that my <span class="in">`enterpriseID`</span> is set, even though I am a single</span>
<span id="cb38-579"><a href="#cb38-579" aria-hidden="true" tabindex="-1"></a>  developer on a free box plan. If your <span class="in">`enterpriseID`</span> is set to "0", you</span>
<span id="cb38-580"><a href="#cb38-580" aria-hidden="true" tabindex="-1"></a>  probably didn't sign up for a _Developer_ account. (Only free Developer</span>
<span id="cb38-581"><a href="#cb38-581" aria-hidden="true" tabindex="-1"></a>  accounts or paid plans can authorize apps via JWT or CCG).</span>
<span id="cb38-582"><a href="#cb38-582" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-583"><a href="#cb38-583" aria-hidden="true" tabindex="-1"></a>  The contents (or location) of this file is required to authenticate with</span>
<span id="cb38-584"><a href="#cb38-584" aria-hidden="true" tabindex="-1"></a>  box. The </span>
<span id="cb38-585"><a href="#cb38-585" aria-hidden="true" tabindex="-1"></a>  <span class="co">[</span><span class="ot">boxr package authors reccommend</span><span class="co">](https://r-box.github.io/boxr/articles/boxr-app-service.html#using-a-service-app)</span></span>
<span id="cb38-586"><a href="#cb38-586" aria-hidden="true" tabindex="-1"></a>  creating storing this file in a newly created <span class="in">`~/.boxr-auth`</span> folder, and</span>
<span id="cb38-587"><a href="#cb38-587" aria-hidden="true" tabindex="-1"></a>  in this tutorial stored the file there under the path </span>
<span id="cb38-588"><a href="#cb38-588" aria-hidden="true" tabindex="-1"></a>  <span class="in">`~/.boxr-auth/jwt_config.json`</span> <span class="ot">[^6]</span>.</span>
<span id="cb38-589"><a href="#cb38-589" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-590"><a href="#cb38-590" aria-hidden="true" tabindex="-1"></a>  <span class="ot">[^6]: </span>The authors also recommend to keep access to the folder restricted if</span>
<span id="cb38-591"><a href="#cb38-591" aria-hidden="true" tabindex="-1"></a>  you are on a system shared with others, e.g. by creating the directory</span>
<span id="cb38-592"><a href="#cb38-592" aria-hidden="true" tabindex="-1"></a>  with the <span class="in">`fs::dir_create("~/.boxr-auth", mode = 700)`</span> command.</span>
<span id="cb38-593"><a href="#cb38-593" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-594"><a href="#cb38-594" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb38-595"><a href="#cb38-595" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-596"><a href="#cb38-596" aria-hidden="true" tabindex="-1"></a>The contents of the JSON file is sufficient to access my box account. So I</span>
<span id="cb38-597"><a href="#cb38-597" aria-hidden="true" tabindex="-1"></a>need to keep it secret, and - if in doubt - revoke and replace the key pair</span>
<span id="cb38-598"><a href="#cb38-598" aria-hidden="true" tabindex="-1"></a>with a new one.</span>
<span id="cb38-599"><a href="#cb38-599" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-600"><a href="#cb38-600" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb38-601"><a href="#cb38-601" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-602"><a href="#cb38-602" aria-hidden="true" tabindex="-1"></a><span class="fu">### Authorizing the JWT-backed app</span></span>
<span id="cb38-603"><a href="#cb38-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-604"><a href="#cb38-604" aria-hidden="true" tabindex="-1"></a>In contrast to the OAuth 2.0 app I created above, any JWT-backed app needs to</span>
<span id="cb38-605"><a href="#cb38-605" aria-hidden="true" tabindex="-1"></a>be explicitly authorized by the organization's admin. Here, I am using a free</span>
<span id="cb38-606"><a href="#cb38-606" aria-hidden="true" tabindex="-1"></a>developer box account, so I am my own admin and can perform the following steps.</span>
<span id="cb38-607"><a href="#cb38-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-608"><a href="#cb38-608" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>I navigate to the <span class="co">[</span><span class="ot">home page of my box account</span><span class="co">](https://app.box.com/folder/0)</span></span>
<span id="cb38-609"><a href="#cb38-609" aria-hidden="true" tabindex="-1"></a>  and click on the <span class="in">`Admin Console`</span> button on the lower left of the page. (If</span>
<span id="cb38-610"><a href="#cb38-610" aria-hidden="true" tabindex="-1"></a>  you don't see an option to access the Admin Console the you either have not</span>
<span id="cb38-611"><a href="#cb38-611" aria-hidden="true" tabindex="-1"></a>  signed up for a _Developer_ account, or your organization has dedicated</span>
<span id="cb38-612"><a href="#cb38-612" aria-hidden="true" tabindex="-1"></a>  admins<span class="ot">[^7]</span> and you are not one of them.)</span>
<span id="cb38-613"><a href="#cb38-613" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-614"><a href="#cb38-614" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb38-615"><a href="#cb38-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-616"><a href="#cb38-616" aria-hidden="true" tabindex="-1"></a><span class="fu">### Screenshot</span></span>
<span id="cb38-617"><a href="#cb38-617" aria-hidden="true" tabindex="-1"></a><span class="al">![](screenshots/admin_console.jpg)</span>{#fig-admin_console}</span>
<span id="cb38-618"><a href="#cb38-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-619"><a href="#cb38-619" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb38-620"><a href="#cb38-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-621"><a href="#cb38-621" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Within the admin console, I select <span class="in">`Integrations`</span> in the left hand menu, and</span>
<span id="cb38-622"><a href="#cb38-622" aria-hidden="true" tabindex="-1"></a>  then navigate to the <span class="in">`Platform Apps Manager`</span> tab. Here, I can see all</span>
<span id="cb38-623"><a href="#cb38-623" aria-hidden="true" tabindex="-1"></a>  previously authorized apps - but as this is my first JWT app there aren't any</span>
<span id="cb38-624"><a href="#cb38-624" aria-hidden="true" tabindex="-1"></a>  listed.</span>
<span id="cb38-625"><a href="#cb38-625" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-626"><a href="#cb38-626" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb38-627"><a href="#cb38-627" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-628"><a href="#cb38-628" aria-hidden="true" tabindex="-1"></a><span class="fu">### Screenshot</span></span>
<span id="cb38-629"><a href="#cb38-629" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-630"><a href="#cb38-630" aria-hidden="true" tabindex="-1"></a><span class="al">![](screenshots/platform_apps_manager_1.jpg)</span>{#fig-platform_apps_manager_1}</span>
<span id="cb38-631"><a href="#cb38-631" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-632"><a href="#cb38-632" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb38-633"><a href="#cb38-633" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-634"><a href="#cb38-634" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>To add my new app, I click on the <span class="in">`Add Platform App`</span> button on the upper</span>
<span id="cb38-635"><a href="#cb38-635" aria-hidden="true" tabindex="-1"></a>  right of the page.</span>
<span id="cb38-636"><a href="#cb38-636" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Within the modal that pops up, I paste my app's <span class="in">`ClientID`</span>, which I can</span>
<span id="cb38-637"><a href="#cb38-637" aria-hidden="true" tabindex="-1"></a>    find either in the JSON token file or on the app's configuration page (</span>
<span id="cb38-638"><a href="#cb38-638" aria-hidden="true" tabindex="-1"></a>    see above).</span>
<span id="cb38-639"><a href="#cb38-639" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>After pressing the <span class="in">`Next`</span> button, I can confirm the details and authorize</span>
<span id="cb38-640"><a href="#cb38-640" aria-hidden="true" tabindex="-1"></a>    my app.</span>
<span id="cb38-641"><a href="#cb38-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-642"><a href="#cb38-642" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb38-643"><a href="#cb38-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-644"><a href="#cb38-644" aria-hidden="true" tabindex="-1"></a><span class="fu">### Screenshots</span></span>
<span id="cb38-645"><a href="#cb38-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-646"><a href="#cb38-646" aria-hidden="true" tabindex="-1"></a>:::: {layout-ncol=2}</span>
<span id="cb38-647"><a href="#cb38-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-648"><a href="#cb38-648" aria-hidden="true" tabindex="-1"></a><span class="al">![](screenshots/add_platform_app_1.jpg)</span>{#fig-add_platform_app_1}</span>
<span id="cb38-649"><a href="#cb38-649" aria-hidden="true" tabindex="-1"></a><span class="al">![](screenshots/add_platform_app_2.jpg)</span>{#fig-add_platform_app_2}</span>
<span id="cb38-650"><a href="#cb38-650" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb38-651"><a href="#cb38-651" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb38-652"><a href="#cb38-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-653"><a href="#cb38-653" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Once the authorization is complete, I can see my <span class="in">`r_jwt`</span> app listed in the</span>
<span id="cb38-654"><a href="#cb38-654" aria-hidden="true" tabindex="-1"></a>  <span class="in">`Platform Apps Manager`</span> list.</span>
<span id="cb38-655"><a href="#cb38-655" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-656"><a href="#cb38-656" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb38-657"><a href="#cb38-657" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-658"><a href="#cb38-658" aria-hidden="true" tabindex="-1"></a><span class="fu">### Screenshot</span></span>
<span id="cb38-659"><a href="#cb38-659" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-660"><a href="#cb38-660" aria-hidden="true" tabindex="-1"></a><span class="al">![](screenshots/platform_apps_manager_2.jpg)</span>{#fig-platform_apps_manager_2}</span>
<span id="cb38-661"><a href="#cb38-661" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb38-662"><a href="#cb38-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-663"><a href="#cb38-663" aria-hidden="true" tabindex="-1"></a><span class="ot">[^7]: </span>If you are part of an organization with dedicated admins, you need to ask</span>
<span id="cb38-664"><a href="#cb38-664" aria-hidden="true" tabindex="-1"></a>them to authorize your app for you, and provide them with its <span class="in">`ClienID`</span>.</span>
<span id="cb38-665"><a href="#cb38-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-666"><a href="#cb38-666" aria-hidden="true" tabindex="-1"></a><span class="fu">### Authenticating with the JSON web-token</span></span>
<span id="cb38-667"><a href="#cb38-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-668"><a href="#cb38-668" aria-hidden="true" tabindex="-1"></a>For JWT authentication, the <span class="in">`box_auth_service()`</span> function is used. I can either</span>
<span id="cb38-669"><a href="#cb38-669" aria-hidden="true" tabindex="-1"></a>point its <span class="in">`token_file`</span> argument to the JSON file downloaded above, or provide</span>
<span id="cb38-670"><a href="#cb38-670" aria-hidden="true" tabindex="-1"></a>its content as a string via its <span class="in">`token_text`</span> argument <span class="ot">[^5]</span>. (Alternatively,</span>
<span id="cb38-671"><a href="#cb38-671" aria-hidden="true" tabindex="-1"></a>I could also provide the path to the JSON file via the <span class="in">`BOX_TOKEN_FILE`</span></span>
<span id="cb38-672"><a href="#cb38-672" aria-hidden="true" tabindex="-1"></a>environmental variable.)</span>
<span id="cb38-673"><a href="#cb38-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-674"><a href="#cb38-674" aria-hidden="true" tabindex="-1"></a><span class="ot">[^5]: </span>I do some of my analyses using <span class="co">[</span><span class="ot">Saturn Cloud</span><span class="co">](https://saturncloud.io/)</span>, </span>
<span id="cb38-675"><a href="#cb38-675" aria-hidden="true" tabindex="-1"></a>which offers  convenient ways to inject _secrets_ into cloud instances - either</span>
<span id="cb38-676"><a href="#cb38-676" aria-hidden="true" tabindex="-1"></a>as environmental variables or text files. Because the JWT file is plain text, it</span>
<span id="cb38-677"><a href="#cb38-677" aria-hidden="true" tabindex="-1"></a>works very well with that setup.</span>
<span id="cb38-678"><a href="#cb38-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-681"><a href="#cb38-681" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-682"><a href="#cb38-682" aria-hidden="true" tabindex="-1"></a>boxr<span class="sc">::</span><span class="fu">box_auth_service</span>(<span class="at">token_file =</span> <span class="st">"~/.boxr-auth/jwt_config.json"</span>)</span>
<span id="cb38-683"><a href="#cb38-683" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-684"><a href="#cb38-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-685"><a href="#cb38-685" aria-hidden="true" tabindex="-1"></a>Once the <span class="in">`box_auth_service()`</span> call has completed successfully, I can explore</span>
<span id="cb38-686"><a href="#cb38-686" aria-hidden="true" tabindex="-1"></a>the files and folders in box.</span>
<span id="cb38-687"><a href="#cb38-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-690"><a href="#cb38-690" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-691"><a href="#cb38-691" aria-hidden="true" tabindex="-1"></a>boxr<span class="sc">::</span><span class="fu">box_ls</span>()</span>
<span id="cb38-692"><a href="#cb38-692" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-693"><a href="#cb38-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-694"><a href="#cb38-694" aria-hidden="true" tabindex="-1"></a>Wait, the <span class="in">`box_ls()`</span> command does return any objects - where is my </span>
<span id="cb38-695"><a href="#cb38-695" aria-hidden="true" tabindex="-1"></a><span class="in">`tutorials`</span> folder? This bring me to a key difference between OAuth 2.0 and</span>
<span id="cb38-696"><a href="#cb38-696" aria-hidden="true" tabindex="-1"></a>JWT backed apps: the former has access to my usual box account. But the </span>
<span id="cb38-697"><a href="#cb38-697" aria-hidden="true" tabindex="-1"></a>latter uses a _service account_, an entirely separate box account that has</span>
<span id="cb38-698"><a href="#cb38-698" aria-hidden="true" tabindex="-1"></a>access to _its own_ file system, but cannot access those of my main account.</span>
<span id="cb38-699"><a href="#cb38-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-700"><a href="#cb38-700" aria-hidden="true" tabindex="-1"></a><span class="fu">### Sharing files and folders with the service account</span></span>
<span id="cb38-701"><a href="#cb38-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-702"><a href="#cb38-702" aria-hidden="true" tabindex="-1"></a>For some applications, up- and down-loading files that are _only_ accessible</span>
<span id="cb38-703"><a href="#cb38-703" aria-hidden="true" tabindex="-1"></a>via the service account might be all that is needed. But to collaborate with</span>
<span id="cb38-704"><a href="#cb38-704" aria-hidden="true" tabindex="-1"></a>others (including my interactive account), it is helpful to _share_ files with</span>
<span id="cb38-705"><a href="#cb38-705" aria-hidden="true" tabindex="-1"></a>this new account. That's what </span>
<span id="cb38-706"><a href="#cb38-706" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">collaboration workflows</span><span class="co">](https://r-box.github.io/boxr/articles/boxr-app-service.html#collaboration-workflows)</span></span>
<span id="cb38-707"><a href="#cb38-707" aria-hidden="true" tabindex="-1"></a>are for.</span>
<span id="cb38-708"><a href="#cb38-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-709"><a href="#cb38-709" aria-hidden="true" tabindex="-1"></a>Here, I will give the service account access to my <span class="in">`tutorial`</span> folder, which is</span>
<span id="cb38-710"><a href="#cb38-710" aria-hidden="true" tabindex="-1"></a>owned by my main account (and which I accessed using OAuth 2.0 above).</span>
<span id="cb38-711"><a href="#cb38-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-712"><a href="#cb38-712" aria-hidden="true" tabindex="-1"></a>To share the folder (e.g. to _create a collaboration_ in box' lingo), I need to</span>
<span id="cb38-713"><a href="#cb38-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-714"><a href="#cb38-714" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Log in to my main account, either interactive via the box website or using</span>
<span id="cb38-715"><a href="#cb38-715" aria-hidden="true" tabindex="-1"></a>  OAuth 2.0.</span>
<span id="cb38-716"><a href="#cb38-716" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Provide the identifier of the folder I want to share</span>
<span id="cb38-717"><a href="#cb38-717" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Provide <span class="in">`user_id`</span> of the service account I want to share the folder with.</span>
<span id="cb38-718"><a href="#cb38-718" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>This information was returned by the <span class="in">`box_auth_service()`</span> call above. </span>
<span id="cb38-719"><a href="#cb38-719" aria-hidden="true" tabindex="-1"></a>    In this example the <span class="in">`user_id`</span> is <span class="in">`38323581037`</span>.</span>
<span id="cb38-720"><a href="#cb38-720" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Decide on the <span class="in">`role`</span>, e.g. the set of permissions, I want to grant to the</span>
<span id="cb38-721"><a href="#cb38-721" aria-hidden="true" tabindex="-1"></a>  service account.</span>
<span id="cb38-722"><a href="#cb38-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-723"><a href="#cb38-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-726"><a href="#cb38-726" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-727"><a href="#cb38-727" aria-hidden="true" tabindex="-1"></a><span class="fu">box_auth</span>()                                    <span class="co"># &lt;1&gt;</span></span>
<span id="cb38-728"><a href="#cb38-728" aria-hidden="true" tabindex="-1"></a>objects <span class="ot">&lt;-</span> boxr<span class="sc">::</span><span class="fu">box_ls</span>()                     <span class="co"># &lt;2&gt;</span></span>
<span id="cb38-729"><a href="#cb38-729" aria-hidden="true" tabindex="-1"></a>folder_id <span class="ot">&lt;-</span> objects <span class="sc">|&gt;</span>                       <span class="co"># &lt;3&gt;</span></span>
<span id="cb38-730"><a href="#cb38-730" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb38-731"><a href="#cb38-731" aria-hidden="true" tabindex="-1"></a>  poorman<span class="sc">::</span><span class="fu">filter</span>(name <span class="sc">==</span> <span class="st">"tutorial"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb38-732"><a href="#cb38-732" aria-hidden="true" tabindex="-1"></a>  poorman<span class="sc">::</span><span class="fu">pull</span>(<span class="st">"id"</span>)</span>
<span id="cb38-733"><a href="#cb38-733" aria-hidden="true" tabindex="-1"></a>boxr<span class="sc">::</span><span class="fu">box_collab_get</span>(folder_id)               <span class="co"># &lt;4&gt;</span></span>
<span id="cb38-734"><a href="#cb38-734" aria-hidden="true" tabindex="-1"></a>boxr<span class="sc">::</span><span class="fu">box_collab_create</span>(                      <span class="co"># &lt;5&gt;</span></span>
<span id="cb38-735"><a href="#cb38-735" aria-hidden="true" tabindex="-1"></a>  <span class="at">dir_id =</span> folder_id, </span>
<span id="cb38-736"><a href="#cb38-736" aria-hidden="true" tabindex="-1"></a>  <span class="at">user_id =</span> <span class="st">"38323581037"</span>, </span>
<span id="cb38-737"><a href="#cb38-737" aria-hidden="true" tabindex="-1"></a>  <span class="at">role =</span> <span class="st">"co-owner"</span>) <span class="sc">|&gt;</span></span>
<span id="cb38-738"><a href="#cb38-738" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb38-739"><a href="#cb38-739" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-740"><a href="#cb38-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-741"><a href="#cb38-741" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Re-authenticate with my OAuth 2.0 credentials.</span>
<span id="cb38-742"><a href="#cb38-742" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>List files &amp; folders at the root of my box account.</span>
<span id="cb38-743"><a href="#cb38-743" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Extract the identifier of the <span class="in">`tutorial`</span> folder.</span>
<span id="cb38-744"><a href="#cb38-744" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Confirm that the folder currently doesn't have collaborators, e.g. is not</span>
<span id="cb38-745"><a href="#cb38-745" aria-hidden="true" tabindex="-1"></a>  shared with any other box account (service or otherwise).</span>
<span id="cb38-746"><a href="#cb38-746" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Share the <span class="in">`tutorial`</span> folder with the service account, whose use_id is</span>
<span id="cb38-747"><a href="#cb38-747" aria-hidden="true" tabindex="-1"></a>   <span class="in">`38323581037`</span>.</span>
<span id="cb38-748"><a href="#cb38-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-749"><a href="#cb38-749" aria-hidden="true" tabindex="-1"></a>Now that the service account has access to the <span class="in">`tutorial`</span> folder, I </span>
<span id="cb38-750"><a href="#cb38-750" aria-hidden="true" tabindex="-1"></a>re-authenticate via <span class="in">`box_auth_service(). The `</span>r_jwt` app can now list the </span>
<span id="cb38-751"><a href="#cb38-751" aria-hidden="true" tabindex="-1"></a>contents of the <span class="in">`tutorial`</span> folder:</span>
<span id="cb38-752"><a href="#cb38-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-755"><a href="#cb38-755" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-756"><a href="#cb38-756" aria-hidden="true" tabindex="-1"></a>boxr<span class="sc">::</span><span class="fu">box_auth_service</span>(<span class="at">token_file =</span> <span class="st">"~/.boxr-auth/jwt_config.json"</span>)</span>
<span id="cb38-757"><a href="#cb38-757" aria-hidden="true" tabindex="-1"></a>objects <span class="ot">&lt;-</span> boxr<span class="sc">::</span><span class="fu">box_ls</span>(folder_id)</span>
<span id="cb38-758"><a href="#cb38-758" aria-hidden="true" tabindex="-1"></a>objects <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb38-759"><a href="#cb38-759" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-760"><a href="#cb38-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-761"><a href="#cb38-761" aria-hidden="true" tabindex="-1"></a>and it can also write to it:</span>
<span id="cb38-762"><a href="#cb38-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-765"><a href="#cb38-765" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-766"><a href="#cb38-766" aria-hidden="true" tabindex="-1"></a>boxr<span class="sc">::</span><span class="fu">box_save_rds</span>(<span class="at">object =</span> mtcars,</span>
<span id="cb38-767"><a href="#cb38-767" aria-hidden="true" tabindex="-1"></a>                   <span class="at">dir_id =</span> folder_id, </span>
<span id="cb38-768"><a href="#cb38-768" aria-hidden="true" tabindex="-1"></a>                   <span class="at">file_name =</span> <span class="st">"mtcars.rds"</span>,</span>
<span id="cb38-769"><a href="#cb38-769" aria-hidden="true" tabindex="-1"></a>                   <span class="at">description =</span> <span class="st">"The mtcars dataset serialized as an RDS file"</span>)</span>
<span id="cb38-770"><a href="#cb38-770" aria-hidden="true" tabindex="-1"></a>boxr<span class="sc">::</span><span class="fu">box_ls</span>(<span class="at">dir_id =</span> folder_id) <span class="sc">|&gt;</span></span>
<span id="cb38-771"><a href="#cb38-771" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb38-772"><a href="#cb38-772" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-773"><a href="#cb38-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-774"><a href="#cb38-774" aria-hidden="true" tabindex="-1"></a><span class="fu">### Modifying collaborations</span></span>
<span id="cb38-775"><a href="#cb38-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-776"><a href="#cb38-776" aria-hidden="true" tabindex="-1"></a>We can also revoke the permissions of the service account, by deleting the</span>
<span id="cb38-777"><a href="#cb38-777" aria-hidden="true" tabindex="-1"></a>collaboration, if necessary:</span>
<span id="cb38-778"><a href="#cb38-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-781"><a href="#cb38-781" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-782"><a href="#cb38-782" aria-hidden="true" tabindex="-1"></a>boxr<span class="sc">::</span><span class="fu">box_auth</span>()                              <span class="co"># &lt;1&gt;</span></span>
<span id="cb38-783"><a href="#cb38-783" aria-hidden="true" tabindex="-1"></a>collab <span class="ot">&lt;-</span> boxr<span class="sc">::</span><span class="fu">box_collab_get</span>(folder_id)     <span class="co"># &lt;2&gt;</span></span>
<span id="cb38-784"><a href="#cb38-784" aria-hidden="true" tabindex="-1"></a>collab_id <span class="ot">&lt;-</span> collab <span class="sc">|&gt;</span></span>
<span id="cb38-785"><a href="#cb38-785" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb38-786"><a href="#cb38-786" aria-hidden="true" tabindex="-1"></a>  poorman<span class="sc">::</span><span class="fu">pull</span>(id)</span>
<span id="cb38-787"><a href="#cb38-787" aria-hidden="true" tabindex="-1"></a>boxr<span class="sc">::</span><span class="fu">box_collab_delete</span>(collab_id)</span>
<span id="cb38-788"><a href="#cb38-788" aria-hidden="true" tabindex="-1"></a>collab <span class="ot">&lt;-</span> boxr<span class="sc">::</span><span class="fu">box_collab_get</span>(folder_id)     <span class="co"># &lt;3&gt;</span></span>
<span id="cb38-789"><a href="#cb38-789" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-790"><a href="#cb38-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-791"><a href="#cb38-791" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Re-authenticate as the original owner of the folder.</span>
<span id="cb38-792"><a href="#cb38-792" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Retrieve information about the sharing settings / collaborations of the</span>
<span id="cb38-793"><a href="#cb38-793" aria-hidden="true" tabindex="-1"></a>  folder, including the <span class="in">`id`</span> of the collaboration.</span>
<span id="cb38-794"><a href="#cb38-794" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Delete the collaboration by specifying its unique id.</span>
<span id="cb38-795"><a href="#cb38-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-796"><a href="#cb38-796" aria-hidden="true" tabindex="-1"></a><span class="in">```{r cleanup}</span></span>
<span id="cb38-797"><a href="#cb38-797" aria-hidden="true" tabindex="-1"></a><span class="in">#| include: false</span></span>
<span id="cb38-798"><a href="#cb38-798" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb38-799"><a href="#cb38-799" aria-hidden="true" tabindex="-1"></a><span class="in">folder_id &lt;- boxr::box_ls() |&gt;</span></span>
<span id="cb38-800"><a href="#cb38-800" aria-hidden="true" tabindex="-1"></a><span class="in">  as.data.frame() |&gt; </span></span>
<span id="cb38-801"><a href="#cb38-801" aria-hidden="true" tabindex="-1"></a><span class="in">  poorman::filter(name == "tutorial") |&gt; </span></span>
<span id="cb38-802"><a href="#cb38-802" aria-hidden="true" tabindex="-1"></a><span class="in">  poorman::pull("id")</span></span>
<span id="cb38-803"><a href="#cb38-803" aria-hidden="true" tabindex="-1"></a><span class="in">if (length(folder_id) &gt; 0) {</span></span>
<span id="cb38-804"><a href="#cb38-804" aria-hidden="true" tabindex="-1"></a><span class="in">  boxr::box_delete_folder(dir_id = folder_id)</span></span>
<span id="cb38-805"><a href="#cb38-805" aria-hidden="true" tabindex="-1"></a><span class="in">  boxr::box_dir_create("tutorial")</span></span>
<span id="cb38-806"><a href="#cb38-806" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb38-807"><a href="#cb38-807" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-808"><a href="#cb38-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-809"><a href="#cb38-809" aria-hidden="true" tabindex="-1"></a><span class="fu">## Reproducibility</span></span>
<span id="cb38-810"><a href="#cb38-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-811"><a href="#cb38-811" aria-hidden="true" tabindex="-1"></a>&lt;details&gt;</span>
<span id="cb38-812"><a href="#cb38-812" aria-hidden="true" tabindex="-1"></a>&lt;summary&gt;</span>
<span id="cb38-813"><a href="#cb38-813" aria-hidden="true" tabindex="-1"></a>Session Information</span>
<span id="cb38-814"><a href="#cb38-814" aria-hidden="true" tabindex="-1"></a>&lt;/summary&gt;</span>
<span id="cb38-815"><a href="#cb38-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-818"><a href="#cb38-818" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-819"><a href="#cb38-819" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb38-820"><a href="#cb38-820" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-821"><a href="#cb38-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-822"><a href="#cb38-822" aria-hidden="true" tabindex="-1"></a>&lt;/details&gt;</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>